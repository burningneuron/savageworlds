window.CodeMirror=function(){function e(i,s){if(!(this instanceof e))return new e(i,s);this.options=s=s||{};for(var u in ei)!s.hasOwnProperty(u)&&ei.hasOwnProperty(u)&&(s[u]=ei[u]);c(s);var f=this.display=t(i);f.wrapper.CodeMirror=this,a(this),s.autofocus&&!Wr&&Z(this),this.view=n(new On([new An([yn("",null,z(f))])])),this.nextOpId=0,r(this),o(this),s.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),this.setValue(s.value||""),Mr&&setTimeout(sr(Y,this,!0),20),this.view.history=jn(),tt(this);var l;try{l=document.activeElement==f.input}catch(h){}l||s.autofocus&&!Wr?setTimeout(sr(gt,this),20):yt(this),$(this,function(){for(var e in Zr)Zr.propertyIsEnumerable(e)&&Zr[e](this,s[e],ti);for(var t=0;t<si.length;++t)si[t](this)})()}function t(e){var t={},n=t.input=ar("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none;");n.setAttribute("wrap","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),t.inputDiv=ar("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),t.scrollbarH=ar("div",[ar("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),t.scrollbarV=ar("div",[ar("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),t.scrollbarFiller=ar("div",null,"CodeMirror-scrollbar-filler"),t.lineDiv=ar("div"),t.selectionDiv=ar("div",null,null,"position: relative; z-index: 1"),t.cursor=ar("pre"," ","CodeMirror-cursor"),t.otherCursor=ar("pre"," ","CodeMirror-cursor CodeMirror-secondarycursor"),t.measure=ar("div",null,"CodeMirror-measure"),t.lineSpace=ar("div",[t.measure,t.selectionDiv,t.lineDiv,t.cursor,t.otherCursor],null,"position: relative; outline: none"),t.mover=ar("div",[ar("div",[t.lineSpace],"CodeMirror-lines")],null,"position: relative"),t.sizer=ar("div",[t.mover],"CodeMirror-sizer"),t.heightForcer=ar("div"," ",null,"position: absolute; height: "+li+"px"),t.gutters=ar("div",null,"CodeMirror-gutters"),t.lineGutter=null;var r=ar("div",[t.sizer,t.heightForcer,t.gutters],null,"position: relative; min-height: 100%");return t.scroller=ar("div",[r],"CodeMirror-scroll"),t.scroller.setAttribute("tabIndex","-1"),t.wrapper=ar("div",[t.inputDiv,t.scrollbarH,t.scrollbarV,t.scrollbarFiller,t.scroller],"CodeMirror"),_r&&(t.gutters.style.zIndex=-1,t.scroller.style.paddingRight=0),e.appendChild?e.appendChild(t.wrapper):e(t.wrapper),zr&&(n.style.width="0px"),Pr||(t.scroller.draggable=!0),Ir?(t.inputDiv.style.height="1px",t.inputDiv.style.position="absolute"):_r&&(t.scrollbarH.style.minWidth=t.scrollbarV.style.minWidth="18px"),t.viewOffset=t.showingFrom=t.showingTo=t.lastSizeC=0,t.lineNumWidth=t.lineNumInnerWidth=t.lineNumChars=null,t.prevInput="",t.alignWidgets=!1,t.pollingFast=!1,t.poll=new Yn,t.draggingText=!1,t.cachedCharWidth=t.cachedTextHeight=null,t.measureLineCache=[],t.measureLineCachePos=0,t.inaccurateSelection=!1,t.pasteIncoming=!1,t}function n(e){var t={line:0,ch:0};return{doc:e,frontier:0,highlight:new Yn,sel:{from:t,to:t,head:t,anchor:t,shift:!1,extend:!1},scrollTop:0,scrollLeft:0,overwrite:!1,focused:!1,maxLine:Mn(e,0),maxLineLength:0,maxLineChanged:!1,suppressEdits:!1,goalColumn:null,cantEdit:!1,keyMaps:[]}}function r(t){var n=t.view.doc;t.view.mode=e.getMode(t.options,t.options.mode),n.iter(0,n.size,function(e){e.stateAfter=null}),t.view.frontier=0,L(t,100)}function i(e){var t=e.view.doc,n=z(e.display);if(e.options.lineWrapping){e.display.wrapper.className+=" CodeMirror-wrap";var r=e.display.scroller.clientWidth/W(e.display)-3;t.iter(0,t.size,function(e){if(0!=e.height){var t=Math.ceil(e.text.length/r)||1;1!=t&&_n(e,t*n)}}),e.display.sizer.style.minWidth=""}else e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),l(e.view),t.iter(0,t.size,function(e){0!=e.height&&_n(e,n)});J(e,0,t.size),j(e),setTimeout(function(){h(e.display,e.view.doc.height)},100)}function s(e){var t=ui[e.options.keyMap].style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(t?" cm-keymap-"+t:"")}function o(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),j(e)}function u(e){a(e),y(e,!0)}function a(e){var t=e.display.gutters,n=e.options.gutters;fr(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(ar("div",null,"CodeMirror-gutter "+i));"CodeMirror-linenumbers"==i&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none"}function f(e,t){if(0==t.height)return 0;for(var n,r=t.text.length,i=t;n=an(i);){var s=n.find();i=Mn(e,s.from.line),r+=s.from.ch-s.to.ch}for(i=t;n=fn(i);){var s=n.find();r-=i.text.length-s.from.ch,i=Mn(e,s.to.line),r+=i.text.length-s.to.ch}return r}function l(e){e.maxLine=Mn(e.doc,0),e.maxLineLength=f(e.doc,e.maxLine),e.maxLineChanged=!0,e.doc.iter(1,e.doc.size,function(t){var n=f(e.doc,t);n>e.maxLineLength&&(e.maxLineLength=n,e.maxLine=t)})}function c(e){for(var t=!1,n=0;n<e.gutters.length;++n)"CodeMirror-linenumbers"==e.gutters[n]&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function h(e,t){var n=t+2*_(e);e.sizer.style.minHeight=e.heightForcer.style.top=n+"px";var r=Math.max(n,e.scroller.scrollHeight),i=e.scroller.scrollWidth>e.scroller.clientWidth,s=r>e.scroller.clientHeight;s?(e.scrollbarV.style.display="block",e.scrollbarV.style.bottom=i?hr(e.measure)+"px":"0",e.scrollbarV.firstChild.style.height=r-e.scroller.clientHeight+e.scrollbarV.clientHeight+"px"):e.scrollbarV.style.display="",i?(e.scrollbarH.style.display="block",e.scrollbarH.style.right=s?hr(e.measure)+"px":"0",e.scrollbarH.firstChild.style.width=e.scroller.scrollWidth-e.scroller.clientWidth+e.scrollbarH.clientWidth+"px"):e.scrollbarH.style.display="",i&&s?(e.scrollbarFiller.style.display="block",e.scrollbarFiller.style.height=e.scrollbarFiller.style.width=hr(e.measure)+"px"):e.scrollbarFiller.style.display="",qr&&0===hr(e.measure)&&(e.scrollbarV.style.minWidth=e.scrollbarH.style.minHeight=Rr?"18px":"12px")}function p(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight;"number"==typeof n?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-_(e));var s=Math.ceil(r+i);return{from:Pn(t,r),to:Pn(t,s)}}function d(e){var t=e.display;if(t.alignWidgets||t.gutters.firstChild){for(var n=g(t)-t.scroller.scrollLeft+e.view.scrollLeft,r=t.gutters.offsetWidth,i=n+"px",s=t.lineDiv.firstChild;s;s=s.nextSibling)if(s.alignable)for(var o=0,u=s.alignable;o<u.length;++o)u[o].style.left=i;t.gutters.style.left=n+r+"px"}}function v(e){if(!e.options.lineNumbers)return!1;var t=e.view.doc,n=m(e.options,t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(ar("div",[ar("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o),r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",!0}return!1}function m(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function g(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function y(e,t,n){var r=e.display.showingFrom,i=e.display.showingTo,s=b(e,t,n);return s&&(Qn(e,e,"update",e),(e.display.showingFrom!=r||e.display.showingTo!=i)&&Qn(e,e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),T(e),h(e.display,e.view.doc.height),s}function b(e,t,n){var r=e.display,i=e.view.doc;if(!r.wrapper.clientWidth)return r.showingFrom=r.showingTo=r.viewOffset=0,void 0;var s=p(r,i,n);if(!(t!==!0&&0==t.length&&s.from>r.showingFrom&&s.to<r.showingTo)){if(t&&v(e)&&(t=!0),r.sizer.style.marginLeft=r.scrollbarH.style.left=r.gutters.offsetWidth+"px",t!==!0&&$r)for(var o=0;o<t.length;++o)for(var u,a=t[o];u=an(Mn(i,a.from));){var f=u.find().from.line;a.diff&&(a.diff-=a.from-f),a.from=f}var l=t===!0?0:1/0;if(e.options.lineNumbers&&t&&t!==!0)for(var o=0;o<t.length;++o)if(t[o].diff){l=t[o].from;break}var f=Math.max(s.from-e.options.viewportMargin,0),c=Math.min(i.size,s.to+e.options.viewportMargin);if(r.showingFrom<f&&f-r.showingFrom<20&&(f=r.showingFrom),r.showingTo>c&&r.showingTo-c<20&&(c=Math.min(i.size,r.showingTo)),$r)for(f=Dn(ln(i,Mn(i,f)));c<i.size&&cn(Mn(i,c));)++c;for(var h=t===!0?[]:w([{from:r.showingFrom,to:r.showingTo}],t),d=0,o=0;o<h.length;++o){var m=h[o];m.from<f&&(m.from=f),m.to>c&&(m.to=c),m.from>=m.to?h.splice(o--,1):d+=m.to-m.from}if(d!=c-f||f!=r.showingFrom||c!=r.showingTo){h.sort(function(e,t){return e.from-t.from}),.7*(c-f)>d&&(r.lineDiv.style.display="none"),S(e,f,c,h,l),r.lineDiv.style.display="";var g=f!=r.showingFrom||c!=r.showingTo||r.lastSizeC!=r.wrapper.clientHeight;g&&(r.lastSizeC=r.wrapper.clientHeight),r.showingFrom=f,r.showingTo=c,L(e,100);for(var y,b=r.lineDiv.offsetTop,E=r.lineDiv.firstChild;E;E=E.nextSibling)if(E.lineObj){if(_r){var x=E.offsetTop+E.offsetHeight;y=x-b,b=x}else{var T=E.getBoundingClientRect();y=T.bottom-T.top}var N=E.lineObj.height-y;2>y&&(y=z(r)),(N>.001||-0.001>N)&&_n(E.lineObj,y)}return r.viewOffset=Hn(e,Mn(i,f)),r.mover.style.top=r.viewOffset+"px",!0}}}function w(e,t){for(var n=0,r=t.length||0;r>n;++n){for(var i=t[n],s=[],o=i.diff||0,u=0,a=e.length;a>u;++u){var f=e[u];i.to<=f.from&&i.diff?s.push({from:f.from+o,to:f.to+o}):i.to<=f.from||i.from>=f.to?s.push(f):(i.from>f.from&&s.push({from:f.from,to:i.from}),i.to<f.to&&s.push({from:i.to+o,to:f.to+o}))}e=s}return e}function E(e){for(var t=e.display,n={},r={},i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:g(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function S(e,t,n,r,i){function s(t){var n=t.nextSibling;return Pr&&Xr&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):f.removeChild(t),n}var o=E(e),u=e.display,a=e.options.lineNumbers;r.length||Mr||Pr&&e.display.currentWheelTarget||fr(u.lineDiv);var f=u.lineDiv,l=f.firstChild,c=r.shift(),h=t;for(e.view.doc.iter(t,n,function(t){if(c&&c.to==h&&(c=r.shift()),cn(t))0!=t.height&&_n(t,0);else if(c&&c.from<=h&&c.to>h){for(;l.lineObj!=t;)l=s(l);a&&h>=i&&l.lineNumber&&cr(l.lineNumber,m(e.options,h)),l=l.nextSibling}else{var n=x(e,t,h,o);f.insertBefore(n,l),n.lineObj=t}++h});l;)l=s(l)}function x(e,t,n,r){var i=Tn(e,t),s=t.gutterMarkers,o=e.display;if(!(e.options.lineNumbers||s||t.bgClass||t.wrapClass||t.widgets&&t.widgets.length))return i;var u=ar("div",null,t.wrapClass,"position: relative");if(e.options.lineNumbers||s){var a=u.appendChild(ar("div",null,null,"position: absolute; left: "+r.fixedPos+"px"));if(u.alignable=[a],!e.options.lineNumbers||s&&s["CodeMirror-linenumbers"]||(u.lineNumber=a.appendChild(ar("div",m(e.options,n),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+r.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+o.lineNumInnerWidth+"px"))),s)for(var f=0;f<e.options.gutters.length;++f){var l=e.options.gutters[f],c=s.hasOwnProperty(l)&&s[l];c&&a.appendChild(ar("div",[c],"CodeMirror-gutter-elt","left: "+r.gutterLeft[l]+"px; width: "+r.gutterWidth[l]+"px"))}}if(t.bgClass&&u.appendChild(ar("div"," ",t.bgClass+" CodeMirror-linebackground")),u.appendChild(i),t.widgets)for(var h=0,p=t.widgets;h<p.length;++h){var d=p[h],v=ar("div",[d.node],"CodeMirror-linewidget");if(v.widget=d,d.noHScroll){(u.alignable||(u.alignable=[])).push(v);var g=r.wrapperWidth;v.style.left=r.fixedPos+"px",d.coverGutter||(g-=r.gutterTotalWidth,v.style.paddingLeft=r.gutterTotalWidth+"px"),v.style.width=g+"px"}d.coverGutter&&(v.style.zIndex=5,v.style.position="relative",d.noHScroll||(v.style.marginLeft=-r.gutterTotalWidth+"px")),d.above?u.insertBefore(v,e.options.lineNumbers&&0!=t.height?a:i):u.appendChild(v)}return _r&&(u.style.zIndex=2),u}function T(e){var t=e.display,n=Nt(e.view.sel.from,e.view.sel.to);n||e.options.showCursorWhenSelecting?N(e):t.cursor.style.display=t.otherCursor.style.display="none",n?t.selectionDiv.style.display="none":C(e);var r=q(e,e.view.sel.head,"div"),i=t.wrapper.getBoundingClientRect(),s=t.lineDiv.getBoundingClientRect();t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-i.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-i.left))+"px"}function N(e){var t=e.display,n=q(e,e.view.sel.head,"div");t.cursor.style.left=n.left+"px",t.cursor.style.top=n.top+"px",t.cursor.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",t.cursor.style.display="",n.other?(t.otherCursor.style.display="",t.otherCursor.style.left=n.other.left+"px",t.otherCursor.style.top=n.other.top+"px",t.otherCursor.style.height=.85*(n.other.bottom-n.other.top)+"px"):t.otherCursor.style.display="none"}function C(e){function t(e,t,n,r){0>t&&(t=0),o.appendChild(ar("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(null==n?u-e:n)+"px; height: "+(r-t)+"px"))}function n(n,r,s,o){function f(t){return I(e,{line:n,ch:t},"div",l)}var l=Mn(i,n),c=l.text.length,h=o?1/0:-1/0;return dr(Bn(l),r||0,null==s?c:s,function(e,n,i){var l=f("rtl"==i?n-1:e),p=f("rtl"==i?e:n-1),d=l.left,v=p.right;p.top-l.top>3&&(t(d,l.top,null,l.bottom),d=a,l.bottom<p.top&&t(d,l.bottom,null,p.top)),null==s&&n==c&&(v=u),null==r&&0==e&&(d=a),h=o?Math.min(p.top,h):Math.max(p.bottom,h),a+1>d&&(d=a),t(d,p.top,v-d,p.bottom)}),h}var r=e.display,i=e.view.doc,s=e.view.sel,o=document.createDocumentFragment(),u=r.lineSpace.offsetWidth,a=D(e.display);if(s.from.line==s.to.line)n(s.from.line,s.from.ch,s.to.ch);else{for(var f,l,c=Mn(i,s.from.line),h=c,p=[s.from.line,s.from.ch];f=fn(h);){var d=f.find();if(p.push(d.from.ch,d.to.line,d.to.ch),d.to.line==s.to.line){p.push(s.to.ch),l=!0;break}h=Mn(i,d.to.line)}if(l)for(var v=0;v<p.length;v+=3)n(p[v],p[v+1],p[v+2]);else{var m,g,y=Mn(i,s.to.line);m=s.from.ch?n(s.from.line,s.from.ch,null,!1):Hn(e,c)-r.viewOffset,g=s.to.ch?n(s.to.line,an(y)?null:0,s.to.ch,!0):Hn(e,y)-r.viewOffset,g>m&&t(a,m,null,g)}}lr(r.selectionDiv,o),r.selectionDiv.style.display=""}function k(e){var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.offsetHeight&&(t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden")},e.options.cursorBlinkRate)}function L(e,t){e.view.frontier<e.display.showingTo&&e.view.highlight.set(t,sr(A,e))}function A(e){var t=e.view,n=t.doc;if(!(t.frontier>=e.display.showingTo)){var r,i=+(new Date)+e.options.workTime,s=Xt(t.mode,M(e,t.frontier)),o=[];n.iter(t.frontier,Math.min(n.size,e.display.showingTo+500),function(n){return t.frontier>=e.display.showingFrom?(En(e,n,s)&&t.frontier>=e.display.showingFrom&&(r&&r.end==t.frontier?r.end++:o.push(r={start:t.frontier,end:t.frontier+1})),n.stateAfter=Xt(t.mode,s)):(Sn(e,n,s),n.stateAfter=0==t.frontier%5?Xt(t.mode,s):null),++t.frontier,+(new Date)>i?(L(e,e.options.workDelay),!0):void 0}),o.length&&$(e,function(){for(var e=0;e<o.length;++e)J(this,o[e].start,o[e].end)})()}}function O(e,t){for(var n,r,i=e.view.doc,s=t,o=t-100;s>o;--s){if(0==s)return 0;var u=Mn(i,s-1);if(u.stateAfter)return s;var a=Zn(u.text,null,e.options.tabSize);(null==r||n>a)&&(r=s-1,n=a)}return r}function M(e,t){var n=e.view,r=O(e,t),i=r&&Mn(n.doc,r-1).stateAfter;return i=i?Xt(n.mode,i):Vt(n.mode),n.doc.iter(r,t,function(s){Sn(e,s,i);var o=r==t-1||0==r%5||r>=n.showingFrom&&r<n.showingTo;s.stateAfter=o?Xt(n.mode,i):null,++r}),i}function _(e){return e.lineSpace.offsetTop}function D(e){var t=lr(e.measure,ar("pre")).appendChild(ar("span","x"));return t.offsetLeft}function P(e,t,n,r){for(var r=r||H(e,t),i=-1,s=n;;s+=i){var o=r[s];if(o)break;0>i&&0==s&&(i=1)}return{left:n>s?o.right:o.left,right:s>n?o.left:o.right,top:o.top,bottom:o.bottom}}function H(e,t){for(var n=e.display,r=e.display.measureLineCache,i=0;i<r.length;++i){var s=r[i];if(s.text==t.text&&s.markedSpans==t.markedSpans&&n.scroller.clientWidth==s.width)return s.measure}var o=B(e,t),s={text:t.text,width:n.scroller.clientWidth,markedSpans:t.markedSpans,measure:o};return 16==r.length?r[++n.measureLineCachePos%16]=s:r.push(s),o}function B(e,t){var n=e.display,r=ir(t.text.length),i=Tn(e,t,r);if(Mr&&!_r&&!e.options.lineWrapping&&i.childNodes.length>100){for(var s=document.createDocumentFragment(),o=10,u=i.childNodes.length,a=0,f=Math.ceil(u/o);f>a;++a){for(var l=ar("div",null,null,"display: inline-block"),c=0;o>c&&u;++c)l.appendChild(i.firstChild),--u;s.appendChild(l)}i.appendChild(s)}lr(n.measure,i);for(var h,p=n.lineDiv.getBoundingClientRect(),d=[],v=ir(t.text.length),m=i.offsetHeight,a=0;a<r.length;++a)if(h=r[a]){for(var g=h.getBoundingClientRect(),y=Math.max(0,g.top-p.top),b=Math.min(g.bottom-p.top,m),c=0;c<d.length;c+=2){var w=d[c],E=d[c+1];if(!(w>b||y>E)&&(y>=w&&E>=b||w>=y&&b>=E||Math.min(b,E)-Math.max(y,w)>=b-y>>1)){d[c]=Math.min(y,w),d[c+1]=Math.max(b,E);break}}c==d.length&&d.push(y,b),v[a]={left:g.left-p.left,right:g.right-p.left,top:c}}for(var h,a=0;a<v.length;++a)if(h=v[a]){var S=h.top;h.top=d[S],h.bottom=d[S+1]}return v}function j(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.view.maxLineChanged=!0}function F(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=t.widgets[i].node.offsetHeight;n.top+=s,n.bottom+=s}if("line"==r)return n;r||(r="local");var o=Hn(e,t);if("local"!=r&&(o-=e.display.viewOffset),"page"==r){var u=e.display.lineSpace.getBoundingClientRect();o+=u.top+(window.pageYOffset||(document.documentElement||document.body).scrollTop);var a=u.left+(window.pageXOffset||(document.documentElement||document.body).scrollLeft);n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function I(e,t,n,r){return r||(r=Mn(e.view.doc,t.line)),F(e,r,P(e,r,t.ch),n)}function q(e,t,n,r,i){function s(t,s){var o=P(e,r,t,i);return s?o.left=o.right:o.right=o.left,F(e,r,o,n)}r=r||Mn(e.view.doc,t.line),i||(i=H(e,r));var o=Bn(r),u=t.ch;if(!o)return s(u);for(var a,f,l=o[0].level,c=0;c<o.length;++c){var h,p,d=o[c],v=d.level%2;if(d.from<u&&d.to>u)return s(u,v);var m=v?d.to:d.from,g=v?d.from:d.to;if(m==u)p=c&&d.level<(h=o[c-1]).level?s(h.level%2?h.from:h.to-1,!0):s(v&&d.from!=d.to?u-1:u),v==l?a=p:f=p;else if(g==u){var h=c<o.length-1&&o[c+1];if(!v&&h&&h.from==h.to)continue;p=h&&d.level<h.level?s(h.level%2?h.to-1:h.from):s(v?u:u-1,!0),v==l?a=p:f=p}}return l&&!u&&(f=s(o[0].to-1)),a?(f&&(a.other=f),a):f}function R(e,t,n){var r=e.view.doc;if(n+=e.display.viewOffset,0>n)return{line:0,ch:0,outside:!0};var i=Pn(r,n);if(i>=r.size)return{line:r.size-1,ch:Mn(r,r.size-1).text.length};for(0>t&&(t=0);;){var s=Mn(r,i),o=U(e,s,i,t,n),u=fn(s);if(!u||o.ch!=yr(s))return o;i=u.find().to.line}}function U(e,t,n,r,i){function s(r){var i=q(e,{line:n,ch:r},"line",t,f);return u=!0,o>i.bottom?Math.max(0,i.left-a):o<i.top?i.left+a:(u=!1,i.left)}var o=i-Hn(e,t),u=!1,a=e.display.wrapper.clientWidth,f=H(e,t),l=Bn(t),c=t.text.length,h=gr(t),p=yr(t),d=D(e.display),v=s(p);if(r>v)return{line:n,ch:p,outside:u};for(;;){if(l?p==h||p==Er(t,h,1):1>=p-h){for(var m=v-r>r-d,g=m?h:p;di.test(t.text.charAt(g));)++g;return{line:n,ch:g,after:m,outside:u}}var y=Math.ceil(c/2),b=h+y;if(l){b=h;for(var w=0;y>w;++w)b=Er(t,b,1)}var E=s(b);E>r?(p=b,v=E,u&&(v+=1e3),c-=y):(h=b,d=E,c=y)}}function z(e){if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==xr){xr=ar("pre");for(var t=0;49>t;++t)xr.appendChild(document.createTextNode("x")),xr.appendChild(ar("br"));xr.appendChild(document.createTextNode("x"))}lr(e.measure,xr);var n=xr.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),fr(e.measure),n||1}function W(e){if(null!=e.cachedCharWidth)return e.cachedCharWidth;var t=ar("span","x"),n=ar("pre",[t]);lr(e.measure,n);var r=t.offsetWidth;return r>2&&(e.cachedCharWidth=r),r||10}function X(e){e.curOp?++e.curOp.depth:e.curOp={depth:1,changes:[],delayedCallbacks:[],updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,updateMaxLine:!1,id:++e.nextOpId}}function V(e){var t=e.curOp;if(!--t.depth){e.curOp=null;var n=e.view,r=e.display;if(t.updateMaxLine&&l(n),n.maxLineChanged&&!e.options.lineWrapping){var i=P(e,n.maxLine,n.maxLine.text.length).right;r.sizer.style.minWidth=i+3+li+"px",n.maxLineChanged=!1}var s,o;if(t.selectionChanged){var u=q(e,n.sel.head);s=Ft(e,u.left,u.top,u.left,u.bottom)}(t.changes.length||s&&null!=s.scrollTop)&&(o=y(e,t.changes,s&&s.scrollTop)),!o&&t.selectionChanged&&T(e),s&&Ht(e),t.selectionChanged&&k(e),n.focused&&t.updateInput&&Y(e,t.userSelChange),t.textChanged&&Kn(e,"change",e,t.textChanged),t.selectionChanged&&Kn(e,"cursorActivity",e);for(var a=0;a<t.delayedCallbacks.length;++a)t.delayedCallbacks[a](e)}}function $(e,t){return function(){var n=e||this;X(n);try{var r=t.apply(n,arguments)}finally{V(n)}return r}}function J(e,t,n,r){e.curOp.changes.push({from:t,to:n,diff:r})}function K(e){e.view.pollingFast||e.display.poll.set(e.options.pollInterval,function(){G(e),e.view.focused&&K(e)})}function Q(e){function t(){var r=G(e);r||n?(e.display.pollingFast=!1,K(e)):(n=!0,e.display.poll.set(60,t))}var n=!1;e.display.pollingFast=!0,e.display.poll.set(20,t)}function G(e){var t=e.display.input,n=e.display.prevInput,r=e.view,i=r.sel;if(!r.focused||wi(t)||et(e))return!1;var s=t.value;if(s==n&&Nt(i.from,i.to))return!1;X(e),r.sel.shift=!1;for(var o=0,u=Math.min(n.length,s.length);u>o&&n[o]==s[o];)++o;var a=i.from,f=i.to;o<n.length?a={line:a.line,ch:a.ch-(n.length-o)}:r.overwrite&&Nt(a,f)&&!e.display.pasteIncoming&&(f={line:f.line,ch:Math.min(Mn(e.view.doc,f.line).text.length,f.ch+(s.length-o))});var l=e.curOp.updateInput;return wt(e,a,f,bi(s.slice(o)),"end",e.display.pasteIncoming?"paste":"input",{from:a,to:f}),e.curOp.updateInput=l,s.length>1e3?t.value=e.display.prevInput="":e.display.prevInput=s,V(e),e.display.pasteIncoming=!1,!0}function Y(e,t){var n,r,i=e.view;Nt(i.sel.from,i.sel.to)?t&&(e.display.prevInput=e.display.input.value=""):(e.display.prevInput="",n=Ei&&(i.sel.to.line-i.sel.from.line>100||(r=e.getSelection()).length>1e3),e.display.input.value=n?"-":r||e.getSelection(),i.focused&&nr(e.display.input)),e.display.inaccurateSelection=n}function Z(e){"nocursor"==e.options.readOnly||!Mr&&document.activeElement==e.display.input||e.display.input.focus()}function et(e){return e.options.readOnly||e.view.cantEdit}function tt(e){function t(){e.view.focused&&setTimeout(sr(Z,e),0)}function n(t){e.options.onDragEvent&&e.options.onDragEvent(e,qn(t))||zn(t)}function r(){i.inaccurateSelection&&(i.prevInput="",i.inaccurateSelection=!1,i.input.value=e.getSelection(),nr(i.input))}var i=e.display;$n(i.scroller,"mousedown",$(e,it)),$n(i.scroller,"dblclick",$(e,Rn)),$n(i.lineSpace,"selectstart",function(e){nt(i,e)||Rn(e)}),Or||$n(i.scroller,"contextmenu",function(t){bt(e,t)}),$n(i.scroller,"scroll",function(){at(e,i.scroller.scrollTop),ft(e,i.scroller.scrollLeft,!0),Kn(e,"scroll",e)}),$n(i.scrollbarV,"scroll",function(){at(e,i.scrollbarV.scrollTop)}),$n(i.scrollbarH,"scroll",function(){ft(e,i.scrollbarH.scrollLeft)}),$n(i.scroller,"mousewheel",function(t){lt(e,t)}),$n(i.scroller,"DOMMouseScroll",function(t){lt(e,t)}),$n(i.scrollbarH,"mousedown",t),$n(i.scrollbarV,"mousedown",t),$n(i.wrapper,"scroll",function(){i.wrapper.scrollTop=i.wrapper.scrollLeft=0}),$n(window,"resize",function s(){i.cachedCharWidth=i.cachedTextHeight=null,j(e),i.wrapper.parentNode?y(e,!0):Jn(window,"resize",s)}),$n(i.input,"keyup",$(e,function(t){e.options.onKeyEvent&&e.options.onKeyEvent(e,qn(t))||16==Vn(t,"keyCode")&&(e.view.sel.shift=!1)})),$n(i.input,"input",sr(Q,e)),$n(i.input,"keydown",$(e,vt)),$n(i.input,"keypress",$(e,mt)),$n(i.input,"focus",sr(gt,e)),$n(i.input,"blur",sr(yt,e)),e.options.dragDrop&&($n(i.scroller,"dragstart",function(t){ut(e,t)}),$n(i.scroller,"dragenter",n),$n(i.scroller,"dragover",n),$n(i.scroller,"drop",$(e,st))),$n(i.scroller,"paste",function(){Z(e),Q(e)}),$n(i.input,"paste",function(){i.pasteIncoming=!0,Q(e)}),$n(i.input,"cut",r),$n(i.input,"copy",r),Ir&&$n(i.sizer,"mouseup",function(){document.activeElement==i.input&&i.input.blur(),Z(e)})}function nt(e,t){for(var n=Wn(t);n!=e.wrapper;n=n.parentNode)if(/\bCodeMirror-(?:line)?widget\b/.test(n.className)||n.parentNode==e.sizer&&n!=e.mover)return!0}function rt(e,t,n){var r=e.display;if(!n){var i=Wn(t);if(i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller)return null}var s,o,u=r.lineSpace.getBoundingClientRect();try{s=t.clientX,o=t.clientY}catch(t){return null}return R(e,s-u.left,o-u.top)}function it(e){function t(e){if("single"==c)return Mt(i,At(a,f),e),void 0;if(m=At(a,m),g=At(a,g),"double"==c){var t=Ut(Mn(a,e.line).text,e);Ct(e,m)?Mt(i,t.from,g):Mt(i,m,t.to)}else"triple"==c&&(Ct(e,m)?Mt(i,g,At(a,{line:e.line,ch:0})):Mt(i,m,At(a,{line:e.line+1,ch:0})))}function n(e){var r=++b,u=rt(i,e,!0);if(u)if(Nt(u,d)){var f=e.clientY<y.top?-20:e.clientY>y.bottom?20:0;f&&setTimeout($(i,function(){b==r&&(s.scroller.scrollTop+=f,n(e))}),50)}else{o.focused||gt(i),d=u,t(u);var l=p(s,a);(u.line>=l.to||u.line<l.from)&&setTimeout($(i,function(){b==r&&n(e)}),150)}}function r(e){b=1/0;var n=rt(i,e);n&&t(n),Rn(e),Z(i),Jn(document,"mousemove",w),Jn(document,"mouseup",E)}var i=this,s=i.display,o=i.view,u=o.sel,a=o.doc;if(u.shift=Vn(e,"shiftKey"),nt(s,e))return Pr||(s.scroller.draggable=!1,setTimeout(function(){s.scroller.draggable=!0},100)),void 0;if(!ot(i,e)){var f=rt(i,e);switch(Xn(e)){case 3:return Or&&bt.call(i,i,e),void 0;case 2:return f&&Mt(i,f),setTimeout(sr(Z,i),20),Rn(e),void 0}if(!f)return Wn(e)==s.scroller&&Rn(e),void 0;o.focused||gt(i);var l=+(new Date),c="single";if(Nr&&Nr.time>l-400&&Nt(Nr.pos,f))c="triple",Rn(e),setTimeout(sr(Z,i),20),zt(i,f.line);else if(Tr&&Tr.time>l-400&&Nt(Tr.pos,f)){c="double",Nr={time:l,pos:f},Rn(e);var h=Ut(Mn(a,f.line).text,f);Mt(i,h.from,h.to)}else Tr={time:l,pos:f};var d=f;if(i.options.dragDrop&&vi&&!et(i)&&!Nt(u.from,u.to)&&!Ct(f,u.from)&&!Ct(u.to,f)&&"single"==c){var v=$(i,function(t){Pr&&(s.scroller.draggable=!1),o.draggingText=!1,Jn(document,"mouseup",v),Jn(s.scroller,"drop",v),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(Rn(t),Mt(i,f),Z(i))});return Pr&&(s.scroller.draggable=!0),o.draggingText=v,s.scroller.dragDrop&&s.scroller.dragDrop(),$n(document,"mouseup",v),$n(s.scroller,"drop",v),void 0}Rn(e),"single"==c&&Mt(i,At(a,f));var m=u.from,g=u.to,y=s.wrapper.getBoundingClientRect(),b=0,w=$(i,function(e){Mr||Xn(e)?n(e):r(e)}),E=$(i,r);$n(document,"mousemove",w),$n(document,"mouseup",E)}}function st(e){var t=this;if(!t.options.onDragEvent||!t.options.onDragEvent(t,qn(e))){Rn(e);var n=rt(t,e,!0),r=e.dataTransfer.files;if(n&&!et(t))if(r&&r.length&&window.FileReader&&window.File)for(var i=r.length,s=Array(i),o=0,u=function(e,r){var u=new FileReader;u.onload=function(){s[r]=u.result,++o==i&&(n=At(t.view.doc,n),$(t,function(){var e=Tt(t,s.join(""),n,n,"paste");_t(t,n,e)})())},u.readAsText(e)},a=0;i>a;++a)u(r[a],a);else{if(t.view.draggingText&&!Ct(n,t.view.sel.from)&&!Ct(t.view.sel.to,n))return t.view.draggingText(e),Mr&&setTimeout(sr(Z,t),50),void 0;try{var s=e.dataTransfer.getData("Text");if(s){var f=t.view.sel.from,l=t.view.sel.to;_t(t,n,n),t.view.draggingText&&Tt(t,"",f,l,"paste"),t.replaceSelection(s,null,"paste"),Z(t),gt(t)}}catch(e){}}}}function ot(e,t){var n=e.display;try{var r=t.clientX,i=t.clientY}catch(t){return!1}if(r>=Math.floor(n.gutters.getBoundingClientRect().right))return!1;if(Rn(t),!Gn(e,"gutterClick"))return!0;var s=n.lineDiv.getBoundingClientRect();if(i>s.bottom)return!0;i-=s.top-n.viewOffset;for(var o=0;o<e.options.gutters.length;++o){var u=n.gutters.childNodes[o];if(u&&u.getBoundingClientRect().right>=r){var a=Pn(e.view.doc,i),f=e.options.gutters[o];Qn(e,e,"gutterClick",e,a,f,t);break}}return!0}function ut(e,t){var n=e.getSelection();t.dataTransfer.setData("Text",n),t.dataTransfer.setDragImage&&!Fr&&t.dataTransfer.setDragImage(ar("img"),0,0)}function at(e,t){Math.abs(e.view.scrollTop-t)<2||(e.view.scrollTop=t,Or||y(e,[],t),e.display.scroller.scrollTop!=t&&(e.display.scroller.scrollTop=t),e.display.scrollbarV.scrollTop!=t&&(e.display.scrollbarV.scrollTop=t),Or&&y(e,[]))}function ft(e,t,n){(n?t==e.view.scrollLeft:Math.abs(e.view.scrollLeft-t)<2)||(e.view.scrollLeft=t,d(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t))}function lt(e,t){var n=t.wheelDeltaX,r=t.wheelDeltaY;if(null==n&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(n=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta),r&&Xr&&Pr)for(var i=t.target;i!=s;i=i.parentNode)if(i.lineObj){e.display.currentWheelTarget=i;break}var s=e.display.scroller;if(n&&!Or&&!jr&&null!=Kr)return r&&at(e,Math.max(0,Math.min(s.scrollTop+r*Kr,s.scrollHeight-s.clientHeight))),ft(e,Math.max(0,Math.min(s.scrollLeft+n*Kr,s.scrollWidth-s.clientWidth))),Rn(t),Lr=null,void 0;if(r&&null!=Kr){var o=r*Kr,u=e.view.scrollTop,a=u+e.display.wrapper.clientHeight;0>o?u=Math.max(0,u+o-50):a=Math.min(e.view.doc.height,a+o+50),y(e,[],{top:u,bottom:a})}20>Jr&&(null==Lr?(Lr=s.scrollLeft,Ar=s.scrollTop,Cr=n,kr=r,setTimeout(function(){if(null!=Lr){var e=s.scrollLeft-Lr,t=s.scrollTop-Ar,n=t&&kr&&t/kr||e&&Cr&&e/Cr;Lr=Ar=null,n&&(Kr=(Kr*Jr+n)/(Jr+1),++Jr)}},200)):(Cr+=n,kr+=r))}function ct(e,t,n){if("string"==typeof t&&(t=oi[t],!t))return!1;e.display.pollingFast&&G(e)&&(e.display.pollingFast=!1);var r=e.view,i=r.sel.shift;try{et(e)&&(r.suppressEdits=!0),n&&(r.sel.shift=!1),t(e)}catch(s){if(s!=ci)throw s;return!1}finally{r.sel.shift=i,r.suppressEdits=!1}return!0}function ht(e){var t=e.view.keyMaps.slice(0);return t.push(e.options.keyMap),e.options.extraKeys&&t.unshift(e.options.extraKeys),t}function pt(e,t){function n(){a=!0}var r=$t(e.options.keyMap),i=r.auto;clearTimeout(Qr),i&&!Kt(t)&&(Qr=setTimeout(function(){$t(e.options.keyMap)==r&&(e.options.keyMap=i.call?i.call(null,e):i)},50));var s=Si[Vn(t,"keyCode")],o=!1,u=Xr&&(jr||Hr);if(null==s||t.altGraphKey)return!1;Vn(t,"altKey")&&(s="Alt-"+s),Vn(t,u?"metaKey":"ctrlKey")&&(s="Ctrl-"+s),Vn(t,u?"ctrlKey":"metaKey")&&(s="Cmd-"+s);var a=!1,f=ht(e);return o=Vn(t,"shiftKey")?Jt("Shift-"+s,f,function(t){return ct(e,t,!0)},n)||Jt(s,f,function(t){return"string"==typeof t&&/^go[A-Z]/.test(t)?ct(e,t):void 0},n):Jt(s,f,function(t){return ct(e,t)},n),a&&(o=!1),o&&(Rn(t),k(e),Dr&&(t.oldKeyCode=t.keyCode,t.keyCode=0)),o}function dt(e,t,n){var r=Jt("'"+n+"'",ht(e),function(t){return ct(e,t,!0)});return r&&(Rn(t),k(e)),r}function vt(e){var t=this;if(t.view.focused||gt(t),Mr&&27==e.keyCode&&(e.returnValue=!1),!t.options.onKeyEvent||!t.options.onKeyEvent(t,qn(e))){var n=Vn(e,"keyCode");t.view.sel.shift=16==n||Vn(e,"shiftKey");var r=pt(t,e);jr&&(Yr=r?n:null,r||88!=n||Ei||!Vn(e,Xr?"metaKey":"ctrlKey")||t.replaceSelection(""))}}function mt(e){var t=this;if(!t.options.onKeyEvent||!t.options.onKeyEvent(t,qn(e))){var n=Vn(e,"keyCode"),r=Vn(e,"charCode");if(jr&&n==Yr)return Yr=null,Rn(e),void 0;if(!(jr&&(!e.which||e.which<10)||Ir)||!pt(t,e)){var i=String.fromCharCode(null==r?n:r);this.options.electricChars&&this.view.mode.electricChars&&this.options.smartIndent&&!et(this)&&this.view.mode.electricChars.indexOf(i)>-1&&setTimeout($(t,function(){It(t,t.view.sel.to.line,"smart")}),75),dt(t,e,i)||Q(t)}}}function gt(e){"nocursor"!=e.options.readOnly&&(e.view.focused||(Kn(e,"focus",e),e.view.focused=!0,-1==e.display.scroller.className.search(/\bCodeMirror-focused\b/)&&(e.display.scroller.className+=" CodeMirror-focused"),Y(e,!0)),K(e),k(e))}function yt(e){e.view.focused&&(Kn(e,"blur",e),e.view.focused=!1,e.display.scroller.className=e.display.scroller.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.view.focused||(e.view.sel.shift=!1)},150)}function bt(e,t){function n(){if(r.inputDiv.style.position="relative",r.input.style.cssText=u,Dr&&(r.scrollbarV.scrollTop=r.scroller.scrollTop=o),K(e),null!=r.input.selectionStart){clearTimeout(Gr);var t=r.input.value=" "+(Nt(i.from,i.to)?"":r.input.value),n=0;r.prevInput=" ",r.input.selectionStart=1,r.input.selectionEnd=t.length,Gr=setTimeout(function s(){" "==r.prevInput&&0==r.input.selectionStart?$(e,oi.selectAll)(e):n++<10?Gr=setTimeout(s,500):Y(e)},200)}}var r=e.display,i=e.view.sel,s=rt(e,t),o=r.scroller.scrollTop;if(s&&!jr){(Nt(i.from,i.to)||Ct(s,i.from)||!Ct(s,i.to))&&$(e,_t)(e,s,s);var u=r.input.style.cssText;r.inputDiv.style.position="absolute",r.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(t.clientY-5)+"px; left: "+(t.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",Z(e),Y(e,!0),Nt(i.from,i.to)&&(r.input.value=r.prevInput=" "),Or?(zn(t),$n(window,"mouseup",function a(){Jn(window,"mouseup",a),setTimeout(n,20)})):setTimeout(n,50)}}function wt(e,t,n,r,i,s){var o=Vr&&on(e.view.doc,t,n);if(!o)return Et(e,t,n,r,i,s);for(var u=o.length-1;u>=1;--u)Et(e,o[u].from,o[u].to,[""],s);return o.length?Et(e,o[0].from,o[0].to,r,i,s):void 0}function Et(e,t,n,r,i,s){if(!e.view.suppressEdits){var o=e.view,u=o.doc,a=[];u.iter(t.line,n.line+1,function(e){a.push(vn(e.text,e.markedSpans))});var f=o.sel.from,l=o.sel.to,c=sn(dn(a[0]),dn(tr(a)),t.ch,n.ch,r),h=xt(e,t,n,c,i,s);return o.history&&Fn(e,t.line,r.length,a,s,f,l,o.sel.from,o.sel.to),h}}function St(e,t){var n=e.view.doc,r=e.view.history,i=("undo"==t?r.done:r.undone).pop();if(i){for(var s={events:[],fromBefore:i.fromAfter,toBefore:i.toAfter,fromAfter:i.fromBefore,toAfter:i.toBefore},o=i.events.length-1;o>=0;o-=1){r.dirtyCounter+="undo"==t?-1:1;var u=i.events[o],a=[],f=u.start+u.added;n.iter(u.start,f,function(e){a.push(vn(e.text,e.markedSpans))}),s.events.push({start:u.start,added:u.old.length,old:a});var l=o?null:{from:i.fromBefore,to:i.toBefore};xt(e,{line:u.start,ch:0},{line:f-1,ch:Mn(n,f-1).text.length},u.old,l,t)}("undo"==t?r.undone:r.done).push(s)}}function xt(e,t,n,r,i,s){var o=e.view,u=o.doc,a=e.display;if(!o.suppressEdits){var l=n.line-t.line,c=Mn(u,t.line),h=Mn(u,n.line),p=!1,d=t.line;e.options.lineWrapping||(d=Dn(ln(u,c)),u.iter(d,n.line+1,function(e){return f(u,e)==o.maxLineLength?(p=!0,!0):void 0}));var v=tr(r),m=z(a);if(0==t.ch&&0==n.ch&&""==pn(v)){for(var g=[],y=0,b=r.length-1;b>y;++y)g.push(yn(pn(r[y]),dn(r[y]),m));bn(e,h,h.text,dn(v)),l&&u.remove(t.line,l,e),g.length&&u.insert(t.line,g)}else if(c==h)if(1==r.length)bn(e,c,c.text.slice(0,t.ch)+pn(r[0])+c.text.slice(n.ch),dn(r[0]));else{for(var g=[],y=1,b=r.length-1;b>y;++y)g.push(yn(pn(r[y]),dn(r[y]),m));g.push(yn(pn(v)+c.text.slice(n.ch),dn(v),m)),bn(e,c,c.text.slice(0,t.ch)+pn(r[0]),dn(r[0])),u.insert(t.line+1,g)}else if(1==r.length)bn(e,c,c.text.slice(0,t.ch)+pn(r[0])+h.text.slice(n.ch),dn(r[0])),u.remove(t.line+1,l,e);else{var g=[];bn(e,c,c.text.slice(0,t.ch)+pn(r[0]),dn(r[0])),bn(e,h,pn(v)+h.text.slice(n.ch),dn(v));for(var y=1,b=r.length-1;b>y;++y)g.push(yn(pn(r[y]),dn(r[y]),m));l>1&&u.remove(t.line+1,l-1,e),u.insert(t.line+1,g)}if(e.options.lineWrapping){var w=Math.max(5,a.scroller.clientWidth/W(a)-3);u.iter(t.line,t.line+r.length,function(e){if(0!=e.height){var t=(Math.ceil(e.text.length/w)||1)*m;t!=e.height&&_n(e,t)}})}else u.iter(d,t.line+r.length,function(e){var t=f(u,e);t>o.maxLineLength&&(o.maxLine=e,o.maxLineLength=t,o.maxLineChanged=!0,p=!1)}),p&&(e.curOp.updateMaxLine=!0);o.frontier=Math.min(o.frontier,t.line),L(e,400);var E=r.length-l-1;if(J(e,t.line,n.line+1,E),Gn(e,"change")){for(var y=0;y<r.length;++y)"string"!=typeof r[y]&&(r[y]=r[y].text);var S={from:t,to:n,text:r,origin:s};if(e.curOp.textChanged){for(var x=e.curOp.textChanged;x.next;x=x.next);x.next=S}else e.curOp.textChanged=S}var T,N,C={line:t.line+r.length-1,ch:pn(v).length+(1==r.length?t.ch:0)};if(i&&"string"!=typeof i)i.from?(T=i.from,N=i.to):T=N=i;else if("end"==i)T=N=C;else if("start"==i)T=N=t;else if("around"==i)T=t,N=C;else{var k=function(e){if(Ct(e,t))return e;if(!Ct(n,e))return C;var r=e.line+E,i=e.ch;return e.line==n.line&&(i+=pn(v).length-(n.ch-(n.line==t.line?t.ch:0))),{line:r,ch:i}};T=k(o.sel.from),N=k(o.sel.to)}return _t(e,T,N,null,!0),C}}function Tt(e,t,n,r,i){if(r||(r=n),Ct(r,n)){var s=r;r=n,n=s}return wt(e,n,r,bi(t),null,i)}function Nt(e,t){return e.line==t.line&&e.ch==t.ch}function Ct(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function kt(e){return{line:e.line,ch:e.ch}}function Lt(e,t){return Math.max(0,Math.min(t,e.size-1))}function At(e,t){if(t.line<0)return{line:0,ch:0};if(t.line>=e.size)return{line:e.size-1,ch:Mn(e,e.size-1).text.length};var n=t.ch,r=Mn(e,t.line).text.length;return null==n||n>r?{line:t.line,ch:r}:0>n?{line:t.line,ch:0}:t}function Ot(e,t){return t>=0&&t<e.size}function Mt(e,t,n,r){var i=e.view.sel;if(i.shift||i.extend){var s=i.anchor;if(n){var o=Ct(t,s);o!=Ct(n,s)?(s=t,t=n):o!=Ct(t,n)&&(t=n)}_t(e,s,t,r)}else _t(e,t,n||t,r);e.curOp.userSelChange=!0}function _t(e,t,n,r,i){e.view.goalColumn=null;var s=e.view.sel;if((i||!Nt(t,s.anchor))&&(t=Pt(e,t,r,"push"!=i)),(i||!Nt(n,s.head))&&(n=Pt(e,n,r,"push"!=i)),!Nt(s.anchor,t)||!Nt(s.head,n)){s.anchor=t,s.head=n;var o=Ct(n,t);s.from=o?n:t,s.to=o?t:n,e.curOp.updateInput=!0,e.curOp.selectionChanged=!0}}function Dt(e){_t(e,e.view.sel.from,e.view.sel.to,null,"push")}function Pt(e,t,n,r){var i=e.view.doc,s=!1,o=t,u=n||1;e.view.cantEdit=!1;e:for(;;){var a,f=Mn(i,o.line);if(f.markedSpans){for(var l=0;l<f.markedSpans.length;++l){var c=f.markedSpans[l],h=c.marker;if((null==c.from||(h.inclusiveLeft?c.from<=o.ch:c.from<o.ch))&&(null==c.to||(h.inclusiveRight?c.to>=o.ch:c.to>o.ch))){if(r&&h.clearOnEnter){(a||(a=[])).push(h);continue}if(!h.atomic)continue;var p=h.find()[0>u?"from":"to"];if(Nt(p,o)&&(p.ch+=u,p.ch<0?p=p.line?At(i,{line:p.line-1}):null:p.ch>f.text.length&&(p=p.line<i.size-1?{line:p.line+1,ch:0}:null),!p)){if(s)return r?(e.view.cantEdit=!0,{line:0,ch:0}):Pt(e,t,n,!0);s=!0,p=t,u=-u}o=p;continue e}}if(a)for(var l=0;l<a.length;++l)a[l].clear()}return o}}function Ht(e){var t=e.view,n=Bt(e,t.sel.head);if(t.focused){var r=e.display,i=r.sizer.getBoundingClientRect(),s=null;if(n.top+i.top<0?s=!0:n.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(s=!1),null!=s&&!Ur){var o="none"==r.cursor.style.display;o&&(r.cursor.style.display="",r.cursor.style.left=n.left+"px",r.cursor.style.top=n.top-r.viewOffset+"px"),r.cursor.scrollIntoView(s),o&&(r.cursor.style.display="none")}}}function Bt(e,t){for(;;){var n=!1,r=q(e,t),i=Ft(e,r.left,r.top,r.left,r.bottom),s=e.view.scrollTop,o=e.view.scrollLeft;if(null!=i.scrollTop&&(at(e,i.scrollTop),Math.abs(e.view.scrollTop-s)>1&&(n=!0)),null!=i.scrollLeft&&(ft(e,i.scrollLeft),Math.abs(e.view.scrollLeft-o)>1&&(n=!0)),!n)return r}}function jt(e,t,n,r,i){var s=Ft(e,t,n,r,i);null!=s.scrollTop&&at(e,s.scrollTop),null!=s.scrollLeft&&ft(e,s.scrollLeft)}function Ft(e,t,n,r,i){var s=e.display,o=_(s);n+=o,i+=o;var u=s.scroller.clientHeight-li,a=s.scroller.scrollTop,f={},l=e.view.doc.height+2*o,c=o+10>n,h=i+o>l-10;a>n?f.scrollTop=c?0:Math.max(0,n):i>a+u&&(f.scrollTop=(h?l:i)-u);var p=s.scroller.clientWidth-li,d=s.scroller.scrollLeft;t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth;var v=s.gutters.offsetWidth,m=v+10>t;return d+v>t||m?(m&&(t=0),f.scrollLeft=Math.max(0,t-10-v)):r>p+d-3&&(f.scrollLeft=r+10-p),f}function It(e,t,n,r){var i=e.view.doc;if(n||(n="add"),"smart"==n)if(e.view.mode.indent)var s=M(e,t);else n="prev";var o,u=e.options.tabSize,a=Mn(i,t),f=Zn(a.text,null,u),l=a.text.match(/^\s*/)[0];if("smart"==n&&(o=e.view.mode.indent(s,a.text.slice(l.length),a.text),o==ci)){if(!r)return;n="prev"}"prev"==n?o=t?Zn(Mn(i,t-1).text,null,u):0:"add"==n?o=f+e.options.indentUnit:"subtract"==n&&(o=f-e.options.indentUnit),o=Math.max(0,o);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(o/u);p;--p)h+=u,c+="	";o>h&&(c+=er(o-h)),c!=l&&Tt(e,c,{line:t,ch:0},{line:t,ch:l.length},"input"),a.stateAfter=null}function qt(e,t,n){var r=t,i=t,s=e.view.doc;return"number"==typeof t?i=Mn(s,Lt(s,t)):r=Dn(t),null==r?null:n(i,r)?(J(e,r,r+1),i):null}function Rt(e,t,n,r){function i(){var e=a+t;return 0>e||e==o.size?!1:(a=e,l=Mn(o,e))}function s(e){var n=(r?Er:Sr)(l,f,t,!0);if(null==n){if(e||!i())return!1;f=r?(0>t?yr:gr)(l):0>t?l.text.length:0}else f=n;return!0}var o=e.view.doc,u=e.view.sel.head,a=u.line,f=u.ch,l=Mn(o,a);if("char"==n)s();else if("column"==n)s(!0);else if("word"==n)for(var c=!1;!(0>t)||s();){if(or(l.text.charAt(f)))c=!0;else if(c){0>t&&(t=1,s());break}if(t>0&&!s())break}return Pt(e,{line:a,ch:f},t,!0)}function Ut(e,t){var n=t.ch,r=t.ch;if(e){t.after===!1||r==e.length?--n:++r;for(var i=e.charAt(n),s=or(i)?or:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!or(e)};n>0&&s(e.charAt(n-1));)--n;for(;r<e.length&&s(e.charAt(r));)++r}return{from:{line:t.line,ch:n},to:{line:t.line,ch:r}}}function zt(e,t){Mt(e,{line:t,ch:0},At(e.view.doc,{line:t+1,ch:0}))}function Wt(t,n,r,i){e.defaults[t]=n,r&&(Zr[t]=i?function(e,t,n){n!=ti&&r(e,t,n)}:r)}function Xt(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function Vt(e,t,n){return e.startState?e.startState(t,n):!0}function $t(e){return"string"==typeof e?ui[e]:e}function Jt(e,t,n,r){function i(t){t=$t(t);var s=t[e];if(s===!1)return r&&r(),!0;if(null!=s&&n(s))return!0;if(t.nofallthrough)return r&&r(),!0;var o=t.fallthrough;if(null==o)return!1;if("[object Array]"!=Object.prototype.toString.call(o))return i(o);for(var u=0,a=o.length;a>u;++u)if(i(o[u]))return!0;return!1}for(var s=0;s<t.length;++s)if(i(t[s]))return!0}function Kt(e){var t=Si[Vn(e,"keyCode")];return"Ctrl"==t||"Alt"==t||"Shift"==t||"Mod"==t}function Qt(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8}function Gt(e,t){this.lines=[],this.type=t,this.cm=e}function Yt(e,t,n,r,i){var s=e.view.doc,o=new Gt(e,i);if("range"==i&&!Ct(t,n))return o;if(r)for(var u in r)r.hasOwnProperty(u)&&(o[u]=r[u]);o.replacedWith&&(o.collapsed=!0,o.replacedWith=ar("span",[o.replacedWith],"CodeMirror-widget")),o.collapsed&&($r=!0);var a,f,l=t.line,c=0;if(s.iter(l,n.line+1,function(e){var r={from:null,to:null,marker:o};c+=e.text.length,l==t.line&&(r.from=t.ch,c-=t.ch),l==n.line&&(r.to=n.ch,c-=e.text.length-n.ch),o.collapsed&&(l==n.line&&(f=un(e,n.ch)),l==t.line?a=un(e,t.ch):_n(e,0)),tn(e,r),o.collapsed&&l==t.line&&cn(e)&&_n(e,0),++l}),o.readOnly&&(Vr=!0,(e.view.history.done.length||e.view.history.undone.length)&&e.clearHistory()),o.collapsed){if(a!=f)throw new Error("Inserting collapsed marker overlapping an existing one");o.size=c,o.atomic=!0}return(o.className||o.startStyle||o.endStyle||o.collapsed)&&J(e,t.line,n.line+1),o.atomic&&Dt(e),o}function Zt(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function en(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function tn(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.lines.push(e)}function nn(e,t){if(e)for(var n,r=0;r<e.length;++r){var i=e[r],s=i.marker,o=null==i.from||(s.inclusiveLeft?i.from<=t:i.from<t);if(o||"bookmark"==s.type&&i.from==t){var u=null==i.to||(s.inclusiveRight?i.to>=t:i.to>t);(n||(n=[])).push({from:i.from,to:u?null:i.to,marker:s})}}return n}function rn(e,t,n){if(e)for(var r,i=0;i<e.length;++i){var s=e[i],o=s.marker,u=null==s.to||(o.inclusiveRight?s.to>=n:s.to>n);if(u||"bookmark"==o.type&&s.from==n&&s.from!=t){var a=null==s.from||(o.inclusiveLeft?s.from<=n:s.from<n);(r||(r=[])).push({from:a?null:s.from-n,to:null==s.to?null:s.to-n,marker:o})}}return r}function sn(e,t,n,r,i){if(!e&&!t)return i;var s=nn(e,n),o=rn(t,n,r),u=1==i.length,a=tr(i).length+(u?n:0);if(s)for(var f=0;f<s.length;++f){var l=s[f];if(null==l.to){var c=Zt(o,l.marker);c?u&&(l.to=null==c.to?null:c.to+a):l.to=n}}if(o)for(var f=0;f<o.length;++f){var l=o[f];if(null!=l.to&&(l.to+=a),null==l.from){var c=Zt(s,l.marker);c||(l.from=a,u&&(s||(s=[])).push(l))}else l.from+=a,u&&(s||(s=[])).push(l)}var h=[vn(i[0],s)];if(!u){var p,d=i.length-2;if(d>0&&s)for(var f=0;f<s.length;++f)null==s[f].to&&(p||(p=[])).push({from:null,to:null,marker:s[f].marker});for(var f=0;d>f;++f)h.push(vn(i[f+1],p));h.push(vn(tr(i),o))}return h}function on(e,t,n){var r=null;if(e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;!n.readOnly||r&&-1!=rr(r,n)||(r||(r=[])).push(n)}}),!r)return null;for(var i=[{from:t,to:n}],s=0;s<r.length;++s)for(var o=r[s].find(),u=0;u<i.length;++u){var a=i[u];if(Ct(o.from,a.to)&&!Ct(o.to,a.from)){var f=[u,1];Ct(a.from,o.from)&&f.push({from:a.from,to:o.from}),Ct(o.to,a.to)&&f.push({from:o.to,to:a.to}),i.splice.apply(i,f),u+=f.length-1}}return i}function un(e,t){var n,r=$r&&e.markedSpans;if(r)for(var i,s=0;s<r.length;++s)i=r[s],i.marker.collapsed&&(null==i.from||i.from<t)&&(null==i.to||i.to>t)&&(!n||n.width<i.marker.width)&&(n=i.marker);return n}function an(e){return un(e,-1)}function fn(e){return un(e,e.text.length+1)}function ln(e,t){for(var n;n=an(t);)t=Mn(e,n.find().from.line);return t}function cn(e){var t=$r&&e.markedSpans;if(t)for(var n,r=0;r<t.length;++r)if(n=t[r],n.marker.collapsed){if(null==n.from)return!0;if(0==n.from&&n.marker.inclusiveLeft&&hn(e,n))return!0}}function hn(e,t){if(null==t.to||t.marker.inclusiveRight&&t.to==e.text.length)return!0;for(var n,r=0;r<e.markedSpans.length;++r)if(n=e.markedSpans[r],n.marker.collapsed&&n.from==t.to&&(n.marker.inclusiveLeft||t.marker.inclusiveRight)&&hn(e,n))return!0}function pn(e){return"string"==typeof e?e:e.text}function dn(e){if("string"==typeof e)return null;for(var t=e.markedSpans,n=null,r=0;r<t.length;++r)t[r].marker.explicitlyCleared?n||(n=t.slice(0,r)):n&&n.push(t[r]);return n?n.length?n:null:t}function vn(e,t){return t?{text:e,markedSpans:t}:e}function mn(e){var t=e.markedSpans;if(t){for(var n=0;n<t.length;++n){var r=t[n].marker.lines,i=rr(r,e);r.splice(i,1)}e.markedSpans=null}}function gn(e,t){if(t){for(var n=0;n<t.length;++n)t[n].marker.lines.push(e);e.markedSpans=t}}function yn(e,t,n){var r={text:e,height:n};return gn(r,t),cn(r)&&(r.height=0),r}function bn(e,t,n,r){t.text=n,t.stateAfter=t.styles=null,null!=t.order&&(t.order=null),mn(t),gn(t,r),cn(t)?t.height=0:t.height||(t.height=z(e.display)),Qn(e,t,"change")}function wn(e){e.parent=null,mn(e)}function En(e,t,n){var r=e.view.mode,i=e.options.flattenSpans,s=!t.styles,o=0,u="",a=null,f=new Qt(t.text,e.options.tabSize),l=t.styles||(t.styles=[]);for(""==t.text&&r.blankLine&&r.blankLine(n);!f.eol();){var c=r.token(f,n),h=f.current();if(f.start=f.pos,i&&a==c?u+=h:(u&&(s=s||o>=l.length||u!=l[o]||a!=l[o+1],l[o++]=u,l[o++]=a),u=h,a=c),f.pos>5e3)break}return u&&(s=s||o>=l.length||u!=l[o]||a!=l[o+1],l[o++]=u,l[o++]=a),f.pos>5e3&&(l[o++]=t.text.slice(f.pos),l[o++]=null),o!=l.length&&(l.length=o,s=!0),s}function Sn(e,t,n){var r=e.view.mode,i=new Qt(t.text,e.options.tabSize);for(""==t.text&&r.blankLine&&r.blankLine(n);!i.eol()&&i.pos<=5e3;)r.token(i,n),i.start=i.pos}function xn(e){return e?ai[e]||(ai[e]="cm-"+e.replace(/ +/g," cm-")):null}function Tn(e,t,n){for(var r,i,s,o=t,u=!0;r=an(o);)u=!1,o=Mn(e.view.doc,r.find().from.line),i||(i=o);var a={pre:ar("pre"),col:0,pos:0,display:!n,measure:null,addedOne:!1,cm:e};o.textClass&&(a.pre.className=o.textClass);do{o.styles||En(e,o,o.stateAfter=M(e,Dn(o))),a.measure=o==t&&n,a.pos=0,a.addToken=a.measure?Cn:Nn,n&&s&&o!=t&&!a.addedOne&&(n[0]=a.pre.appendChild(pr(e.display.measure)),a.addedOne=!0);var f=Ln(o,a);s=o==i,f&&(o=Mn(e.view.doc,f.to.line),u=!1)}while(f);return n&&!a.addedOne&&(n[0]=a.pre.appendChild(u?ar("span"," "):pr(e.display.measure))),a.pre.firstChild||cn(t)||a.pre.appendChild(document.createTextNode(" ")),a.pre}function Nn(e,t,n,r,i){if(t){if(fi.test(t))for(var s=document.createDocumentFragment(),o=0;;){fi.lastIndex=o;var u=fi.exec(t),a=u?u.index-o:t.length-o;if(a&&(s.appendChild(document.createTextNode(t.slice(o,o+a))),e.col+=a),!u)break;if(o+=a+1,"	"==u[0]){var f=e.cm.options.tabSize,l=f-e.col%f;s.appendChild(ar("span",er(l),"cm-tab")),e.col+=l}else{var c=ar("span","•","cm-invalidchar");c.title="\\u"+u[0].charCodeAt(0).toString(16),s.appendChild(c),e.col+=1}}else{e.col+=t.length;var s=document.createTextNode(t)}if(n||r||i||e.measure){var h=n||"";return r&&(h+=r),i&&(h+=i),e.pre.appendChild(ar("span",[s],h))}e.pre.appendChild(s)}}function Cn(e,t,n,r,i){for(var s=0;s<t.length;++s)s&&s<t.length-1&&e.cm.options.lineWrapping&&mi.test(t.slice(s-1,s+1))&&e.pre.appendChild(ar("wbr")),e.measure[e.pos++]=Nn(e,t.charAt(s),n,0==s&&r,s==t.length-1&&i);t.length&&(e.addedOne=!0)}function kn(e,t,n){n&&(e.display||(n=n.cloneNode(!0)),e.pre.appendChild(n),e.measure&&t&&(e.measure[e.pos]=n,e.addedOne=!0)),e.pos+=t}function Ln(e,t){var n=e.styles,r=e.markedSpans;if(r)for(var i,s,o,u,a,f=e.text,l=f.length,c=0,h=0,p="",d=0;;){if(d==c){s=o=u="",a=null,d=1/0;for(var v=null,m=0;m<r.length;++m){var g=r[m],y=g.marker;g.from<=c&&(null==g.to||g.to>c)?(null!=g.to&&d>g.to&&(d=g.to,o=""),y.className&&(s+=" "+y.className),y.startStyle&&g.from==c&&(u+=" "+y.startStyle),y.endStyle&&g.to==d&&(o+=" "+y.endStyle),y.collapsed&&(!a||a.marker.width<y.width)&&(a=g)):g.from>c&&d>g.from&&(d=g.from),"bookmark"==y.type&&g.from==c&&y.replacedWith&&(v=y.replacedWith)}if(a&&(a.from||0)==c&&(kn(t,(null==a.to?l:a.to)-c,null!=a.from&&a.marker.replacedWith),null==a.to))return a.marker.find();v&&!a&&kn(t,0,v)}if(c>=l)break;for(var b=Math.min(l,d);;){if(p){var w=c+p.length;if(!a){var E=w>b?p.slice(0,b-c):p;t.addToken(t,E,i+s,u,c+E.length==d?o:"")}if(w>=b){p=p.slice(b-c),c=b;break}c=w,u=""}p=n[h++],i=xn(n[h++])}}else for(var h=0;h<n.length;h+=2)t.addToken(t,n[h],xn(n[h+1]))}function An(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;n>t;++t)e[t].parent=this,r+=e[t].height;this.height=r}function On(e){this.children=e;for(var t=0,n=0,r=0,i=e.length;i>r;++r){var s=e[r];t+=s.chunkSize(),n+=s.height,s.parent=this}this.size=t,this.height=n,this.parent=null}function Mn(e,t){for(;!e.lines;)for(var n=0;;++n){var r=e.children[n],i=r.chunkSize();if(i>t){e=r;break}t-=i}return e.lines[t]}function _n(e,t){for(var n=t-e.height,r=e;r;r=r.parent)r.height+=n}function Dn(e){if(null==e.parent)return null;for(var t=e.parent,n=rr(t.lines,e),r=t.parent;r;t=r,r=r.parent)for(var i=0;r.children[i]!=t;++i)n+=r.children[i].chunkSize();return n}function Pn(e,t){var n=0;e:do{for(var r=0,i=e.children.length;i>r;++r){var s=e.children[r],o=s.height;if(o>t){e=s;continue e}t-=o,n+=s.chunkSize()}return n}while(!e.lines);for(var r=0,i=e.lines.length;i>r;++r){var u=e.lines[r],a=u.height;if(a>t)break;t-=a}return n+r}function Hn(e,t){t=ln(e.view.doc,t);for(var n=0,r=t.parent,i=0;i<r.lines.length;++i){var s=r.lines[i];if(s==t)break;n+=s.height}for(var o=r.parent;o;r=o,o=r.parent)for(var i=0;i<o.children.length;++i){var u=o.children[i];if(u==r)break;n+=u.height}return n}function Bn(e){var t=e.order;return null==t&&(t=e.order=xi(e.text)),t}function jn(){return{done:[],undone:[],lastTime:0,lastOp:null,lastOrigin:null,dirtyCounter:0}}function Fn(e,t,n,r,i,s,o,u,a){var f=e.view.history;f.undone.length=0;var l=+(new Date),c=tr(f.done);if(c&&(f.lastOp==e.curOp.id||f.lastOrigin==i&&("input"==i||"delete"==i)&&f.lastTime>l-600)){var h=tr(c.events);if(h.start>t+r.length||h.start+h.added<t)c.events.push({start:t,added:n,old:r});else{for(var p=Math.max(0,h.start-t),d=Math.max(0,t+r.length-(h.start+h.added)),v=p;v>0;--v)h.old.unshift(r[v-1]);for(var v=d;v>0;--v)h.old.push(r[r.length-v]);p&&(h.start=t),h.added+=n-(r.length-p-d)}c.fromAfter=u,c.toAfter=a}else{for(c={events:[{start:t,added:n,old:r}],fromBefore:s,toBefore:o,fromAfter:u,toAfter:a},f.done.push(c);f.done.length>e.options.undoDepth;)f.done.shift();f.dirtyCounter<0?f.dirtyCounter=0/0:f.dirtyCounter++}f.lastTime=l,f.lastOp=e.curOp.id,f.lastOrigin=i}function In(){zn(this)}function qn(e){return e.stop||(e.stop=In),e}function Rn(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Un(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function zn(e){Rn(e),Un(e)}function Wn(e){return e.target||e.srcElement}function Xn(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),Xr&&e.ctrlKey&&1==t&&(t=3),t}function Vn(e,t){var n=e.override&&e.override.hasOwnProperty(t);return n?e.override[t]:e[t]}function $n(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}}function Jn(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}}function Kn(e,t){var n=e._handlers&&e._handlers[t];if(n)for(var r=Array.prototype.slice.call(arguments,2),i=0;i<n.length;++i)n[i].apply(null,r)}function Qn(e,t,n){function r(e){return function(){e.apply(null,s)}}var i=t._handlers&&t._handlers[n];if(i)for(var s=Array.prototype.slice.call(arguments,3),o=e.curOp&&e.curOp.delayedCallbacks,u=0;u<i.length;++u)o?o.push(r(i[u])):i[u].apply(null,s)}function Gn(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function Yn(){this.id=null}function Zn(e,t,n){null==t&&(t=e.search(/[^\s\u00a0]/),-1==t&&(t=e.length));for(var r=0,i=0;t>r;++r)"	"==e.charAt(r)?i+=n-i%n:++i;return i}function er(e){for(;hi.length<=e;)hi.push(tr(hi)+" ");return hi[e]}function tr(e){return e[e.length-1]}function nr(e){zr?(e.selectionStart=0,e.selectionEnd=e.value.length):e.select()}function rr(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;r>n;++n)if(e[n]==t)return n;return-1}function ir(e){for(var t=[],n=0;e>n;++n)t.push(void 0);return t}function sr(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function or(e){return/\w/.test(e)||e>""&&(e.toUpperCase()!=e.toLowerCase()||pi.test(e))}function ur(e){var t=0;for(var n in e)e.hasOwnProperty(n)&&e[n]&&++t;return!t}function ar(e,t,n,r){var i=document.createElement(e);if(n&&(i.className=n),r&&(i.style.cssText=r),"string"==typeof t)cr(i,t);else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function fr(e){return e.innerHTML="",e}function lr(e,t){return fr(e).appendChild(t)}function cr(e,t){Dr?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function hr(e){if(null!=gi)return gi;var t=ar("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return lr(e,t),t.offsetWidth&&(gi=t.offsetHeight-t.clientHeight),gi||0}function pr(e){if(null==yi){var t=ar("span","​");lr(e,ar("span",[t,document.createTextNode("x")])),0!=e.firstChild.offsetHeight&&(yi=t.offsetWidth<=1&&t.offsetHeight>2&&!_r)}return yi?ar("span","​"):ar("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")}function dr(e,t,n,r){if(!e)return r(t,n,"ltr");for(var i=0;i<e.length;++i){var s=e[i];s.from<n&&s.to>t&&r(Math.max(s.from,t),Math.min(s.to,n),1==s.level?"rtl":"ltr")}}function vr(e){return e.level%2?e.to:e.from}function mr(e){return e.level%2?e.from:e.to}function gr(e){var t=Bn(e);return t?vr(t[0]):0}function yr(e){var t=Bn(e);return t?mr(tr(t)):e.text.length}function br(e,t){var n=Mn(e.view.doc,t),r=ln(e.view.doc,n);r!=n&&(t=Dn(r));var i=Bn(r),s=i?i[0].level%2?yr(r):gr(r):0;return{line:t,ch:s}}function wr(e,t){for(var n,r;n=fn(r=Mn(e.view.doc,t));)t=n.find().to.line;var i=Bn(r),s=i?i[0].level%2?gr(r):yr(r):r.text.length;return{line:t,ch:s}}function Er(e,t,n,r){var i=Bn(e);if(!i)return Sr(e,t,n,r);for(var s=r?function(t,n){do t+=n;while(t>0&&di.test(e.text.charAt(t)));return t}:function(e,t){return e+t},o=i[0].level,u=0;u<i.length;++u){var a=i[u],f=a.level%2==o;if(a.from<t&&a.to>t||f&&(a.from==t||a.to==t))break}for(var l=s(t,a.level%2?-n:n);null!=l;)if(a.level%2==o){if(!(l<a.from||l>a.to))break;a=i[u+=n],l=a&&(n>0==a.level%2?s(a.to,-1):s(a.from,1))}else if(l==vr(a))a=i[--u],l=a&&mr(a);else{if(l!=mr(a))break;a=i[++u],l=a&&vr(a)}return 0>l||l>e.text.length?null:l}function Sr(e,t,n,r){var i=t+n;if(r)for(;i>0&&di.test(e.text.charAt(i));)i+=n;return 0>i||i>e.text.length?null:i}var xr,Tr,Nr,Cr,kr,Lr,Ar,Or=/gecko\/\d/i.test(navigator.userAgent),Mr=/MSIE \d/.test(navigator.userAgent),_r=/MSIE [1-7]\b/.test(navigator.userAgent),Dr=/MSIE [1-8]\b/.test(navigator.userAgent),Pr=/WebKit\//.test(navigator.userAgent),Hr=Pr&&/Qt\/\d+\.\d+/.test(navigator.userAgent),Br=/Chrome\//.test(navigator.userAgent),jr=/Opera\//.test(navigator.userAgent),Fr=/Apple Computer/.test(navigator.vendor),Ir=/KHTML\//.test(navigator.userAgent),qr=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),Rr=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),Ur=/PhantomJS/.test(navigator.userAgent),zr=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Wr=zr||/Android|webOS|BlackBerry|Opera Mini|IEMobile/i.test(navigator.userAgent),Xr=zr||/Mac/.test(navigator.platform),Vr=!1,$r=!1,Jr=0,Kr=null;Mr?Kr=-0.53:Or?Kr=15:Br?Kr=-0.7:Fr&&(Kr=-1/3);var Qr,Gr,Yr=null;e.prototype={getValue:function(e){var t=[],n=this.view.doc;return n.iter(0,n.size,function(e){t.push(e.text)}),t.join(e||"\n")},setValue:$(null,function(e){var t=this.view.doc,n={line:0,ch:0},r=Mn(t,t.size-1).text.length;Et(this,n,{line:t.size-1,ch:r},bi(e),n,n,"setValue")}),getSelection:function(e){return this.getRange(this.view.sel.from,this.view.sel.to,e)},replaceSelection:$(null,function(e,t,n){var r=this.view.sel;wt(this,r.from,r.to,bi(e),t||"around",n)}),focus:function(){window.focus(),Z(this),gt(this),Q(this)},setOption:function(e,t){var n=this.options,r=n[e];(n[e]!=t||"mode"==e)&&(n[e]=t,Zr.hasOwnProperty(e)&&$(this,Zr[e])(this,t,r))},getOption:function(e){return this.options[e]},getMode:function(){return this.view.mode},addKeyMap:function(e){this.view.keyMaps.push(e)},removeKeyMap:function(e){for(var t=this.view.keyMaps,n=0;n<t.length;++n)if(("string"==typeof e?t[n].name:t[n])==e)return t.splice(n,1),!0},undo:$(null,function(){St(this,"undo")}),redo:$(null,function(){St(this,"redo")}),indentLine:$(null,function(e,t,n){"string"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),Ot(this.view.doc,e)&&It(this,e,t,n)}),indentSelection:$(null,function(e){var t=this.view.sel;if(Nt(t.from,t.to))return It(this,t.from.line,e);for(var n=t.to.line-(t.to.ch?0:1),r=t.from.line;n>=r;++r)It(this,r,e)}),historySize:function(){var e=this.view.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.view.history=jn()},markClean:function(){this.view.history.dirtyCounter=0,this.view.history.lastOp=this.view.history.lastOrigin=null},isClean:function(){return 0==this.view.history.dirtyCounter},getHistory:function(){function e(e){for(var t,n=0,r=[];n<e.length;++n){var i=e[n];r.push({events:t=[],fromBefore:i.fromBefore,toBefore:i.toBefore,fromAfter:i.fromAfter,toAfter:i.toAfter});for(var s=0,o=i.events;s<o.length;++s){var u=[],a=o[s];t.push({start:a.start,added:a.added,old:u});for(var f=0;f<a.old.length;++f)u.push(pn(a.old[f]))}}return r}var t=this.view.history;return{done:e(t.done),undone:e(t.undone)}},setHistory:function(e){var t=this.view.history=jn();t.done=e.done,t.undone=e.undone},getTokenAt:function(e){var t=this.view.doc;e=At(t,e);for(var n=M(this,e.line),r=this.view.mode,i=Mn(t,e.line),s=new Qt(i.text,this.options.tabSize);s.pos<e.ch&&!s.eol();){s.start=s.pos;var o=r.token(s,n)}return{start:s.start,end:s.pos,string:s.current(),className:o||null,type:o||null,state:n}},getStateAfter:function(e){var t=this.view.doc;return e=Lt(t,null==e?t.size-1:e),M(this,e+1)},cursorCoords:function(e,t){var n,r=this.view.sel;return n=null==e?r.head:"object"==typeof e?At(this.view.doc,e):e?r.from:r.to,q(this,n,t||"page")},charCoords:function(e,t){return I(this,At(this.view.doc,e),t||"page")},coordsChar:function(e){var t=this.display.lineSpace.getBoundingClientRect();return R(this,e.left-t.left,e.top-t.top)},defaultTextHeight:function(){return z(this.display)},markText:$(null,function(e,t,n){return Yt(this,At(this.view.doc,e),At(this.view.doc,t),n,"range")}),setBookmark:$(null,function(e,t){return e=At(this.view.doc,e),Yt(this,e,e,t?{replacedWith:t}:{},"bookmark")}),findMarksAt:function(e){var t=this.view.doc;e=At(t,e);var n=[],r=Mn(t,e.line).markedSpans;if(r)for(var i=0;i<r.length;++i){var s=r[i];(null==s.from||s.from<=e.ch)&&(null==s.to||s.to>=e.ch)&&n.push(s.marker)}return n},setGutterMarker:$(null,function(e,t,n){return qt(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&ur(r)&&(e.gutterMarkers=null),!0})}),clearGutter:$(null,function(e){var t=0,n=this,r=n.view.doc;r.iter(0,r.size,function(r){r.gutterMarkers&&r.gutterMarkers[e]&&(r.gutterMarkers[e]=null,J(n,t,t+1),ur(r.gutterMarkers)&&(r.gutterMarkers=null)),++t})}),addLineClass:$(null,function(e,t,n){return qt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass";if(e[r]){if((new RegExp("\\b"+n+"\\b")).test(e[r]))return!1;e[r]+=" "+n}else e[r]=n;return!0})}),removeLineClass:$(null,function(e,t,n){return qt(this,e,function(e){var r="text"==t?"textClass":"background"==t?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(null==n)e[r]=null;else{var s=i.replace(new RegExp("^"+n+"\\b\\s*|\\s*\\b"+n+"\\b"),"");if(s==i)return!1;e[r]=s||null}return!0})}),addLineWidget:$(null,function(e,t,n){var r=n||{};return r.node=t,r.noHScroll&&(this.display.alignWidgets=!0),qt(this,e,function(e){return(e.widgets||(e.widgets=[])).push(r),r.line=e,!0}),r}),removeLineWidget:$(null,function(e){var t=e.line.widgets,n=Dn(e.line);if(null!=n){for(var r=0;r<t.length;++r)t[r]==e&&t.splice(r--,1);J(this,n,n+1)}}),lineInfo:function(e){if("number"==typeof e){if(!Ot(this.view.doc,e))return null;var t=e;if(e=Mn(this.view.doc,e),!e)return null}else{var t=Dn(e);if(null==t)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=q(this,At(this.view.doc,e));var o=e.top,u=e.left;if(t.style.position="absolute",s.sizer.appendChild(t),"over"==r)o=e.top;else if("near"==r){var a=Math.max(s.wrapper.clientHeight,this.view.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);e.bottom+t.offsetHeight>a&&e.top>t.offsetHeight&&(o=e.top-t.offsetHeight),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+_(s)+"px",t.style.left=t.style.right="","right"==i?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==i?u=0:"middle"==i&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&jt(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},lineCount:function(){return this.view.doc.size},clipPos:function(e){return At(this.view.doc,e)},getCursor:function(e){var t,n=this.view.sel;return t=null==e||"head"==e?n.head:"anchor"==e?n.anchor:"end"==e||e===!1?n.to:n.from,kt(t)},somethingSelected:function(){return!Nt(this.view.sel.from,this.view.sel.to)},setCursor:$(null,function(e,t,n){var r=At(this.view.doc,"number"==typeof e?{line:e,ch:t||0}:e);n?Mt(this,r):_t(this,r,r)}),setSelection:$(null,function(e,t){var n=this.view.doc;_t(this,At(n,e),At(n,t||e))}),extendSelection:$(null,function(e,t){var n=this.view.doc;Mt(this,At(n,e),t&&At(n,t))}),setExtending:function(e){this.view.sel.extend=e},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},getLineHandle:function(e){var t=this.view.doc;return Ot(t,e)?Mn(t,e):void 0},getLineNumber:function(e){return Dn(e)},setLine:$(null,function(e,t){Ot(this.view.doc,e)&&Tt(this,t,{line:e,ch:0},{line:e,ch:Mn(this.view.doc,e).text.length})}),removeLine:$(null,function(e){Ot(this.view.doc,e)&&Tt(this,"",{line:e,ch:0},At(this.view.doc,{line:e+1,ch:0}))}),replaceRange:$(null,function(e,t,n){var r=this.view.doc;return t=At(r,t),n=n?At(r,n):t,Tt(this,e,t,n)}),getRange:function(e,t,n){var r=this.view.doc;e=At(r,e),t=At(r,t);var i=e.line,s=t.line;if(i==s)return Mn(r,i).text.slice(e.ch,t.ch);var o=[Mn(r,i).text.slice(e.ch)];return r.iter(i+1,s,function(e){o.push(e.text)}),o.push(Mn(r,s).text.slice(0,t.ch)),o.join(n||"\n")},triggerOnKeyDown:$(null,vt),execCommand:function(e){return oi[e](this)},moveH:$(null,function(e,t){var n=this.view.sel,r=0>e?n.from:n.to;(n.shift||n.extend||Nt(n.from,n.to))&&(r=Rt(this,e,t,!0)),Mt(this,r,r,e)}),deleteH:$(null,function(e,t){var n=this.view.sel;Nt(n.from,n.to)?Tt(this,"",n.from,Rt(this,e,t,!1),"delete"):Tt(this,"",n.from,n.to,"delete"),this.curOp.userSelChange=!0}),moveV:$(null,function(e,t){var n,r=this.view,i=r.doc,s=this.display,o=r.sel.head,u=q(this,o,"div"),a=u.left;if(null!=r.goalColumn&&(a=r.goalColumn),"page"==t){var f=Math.min(s.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);n=u.top+e*f}else"line"==t&&(n=e>0?u.bottom+3:u.top-3);do{var l=R(this,a,n);n+=5*e}while(l.outside&&(0>e?n>0:n<i.height));"page"==t&&(s.scrollbarV.scrollTop+=I(this,l,"div").top-u.top),Mt(this,l,l,e),r.goalColumn=a}),toggleOverwrite:function(){(this.view.overwrite=!this.view.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},posFromIndex:function(e){var t,n=0,r=this.view.doc;return r.iter(0,r.size,function(r){var i=r.text.length+1;return i>e?(t=e,!0):(e-=i,++n,void 0)}),At(r,{line:n,ch:t})},indexFromPos:function(e){if(e.line<0||e.ch<0)return 0;var t=e.ch;return this.view.doc.iter(0,e.line,function(e){t+=e.text.length+1}),t},scrollTo:function(e,t){null!=e&&(this.display.scrollbarH.scrollLeft=this.display.scroller.scrollLeft=e),null!=t&&(this.display.scrollbarV.scrollTop=this.display.scroller.scrollTop=t),y(this,[])},getScrollInfo:function(){var e=this.display.scroller,t=li;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:function(e){"number"==typeof e&&(e={line:e,ch:0}),e=e?At(this.view.doc,e):this.view.sel.head,Bt(this,e)},setSize:function(e,t){function n(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}null!=e&&(this.display.wrapper.style.width=n(e)),null!=t&&(this.display.wrapper.style.height=n(t)),this.refresh()},on:function(e,t){$n(this,e,t)},off:function(e,t){Jn(this,e,t)},operation:function(e){return $(this,e)()},refresh:function(){j(this),this.display.scroller.scrollHeight>this.view.scrollTop&&(this.display.scrollbarV.scrollTop=this.display.scroller.scrollTop=this.view.scrollTop),y(this,!0)},getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};var Zr=e.optionHandlers={},ei=e.defaults={},ti=e.Init={toString:function(){return"CodeMirror.Init"}};Wt("value","",function(e,t){e.setValue(t)},!0),Wt("mode",null,r,!0),Wt("indentUnit",2,r,!0),Wt("indentWithTabs",!1),Wt("smartIndent",!0),Wt("tabSize",4,function(e){r(e),j(e),y(e,!0)},!0),Wt("electricChars",!0),Wt("theme","default",function(e){o(e),u(e)},!0),Wt("keyMap","default",s),Wt("extraKeys",null),Wt("onKeyEvent",null),Wt("onDragEvent",null),Wt("lineWrapping",!1,i,!0),Wt("gutters",[],function(e){c(e.options),u(e)},!0),Wt("lineNumbers",!1,function(e){c(e.options),u(e)},!0),Wt("firstLineNumber",1,u,!0),Wt("lineNumberFormatter",function(e){return e},u,!0),Wt("showCursorWhenSelecting",!1,T,!0),Wt("readOnly",!1,function(e,t){"nocursor"==t?(yt(e),e.display.input.blur()):t||Y(e,!0)}),Wt("dragDrop",!0),Wt("cursorBlinkRate",530),Wt("cursorHeight",1),Wt("workTime",100),Wt("workDelay",100),Wt("flattenSpans",!0),Wt("pollInterval",100),Wt("undoDepth",40),Wt("viewportMargin",10,function(e){e.refresh()},!0),Wt("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Wt("autofocus",null);var ni=e.modes={},ri=e.mimeModes={};e.defineMode=function(t,n){if(e.defaults.mode||"null"==t||(e.defaults.mode=t),arguments.length>2){n.dependencies=[];for(var r=2;r<arguments.length;++r)n.dependencies.push(arguments[r])}ni[t]=n},e.defineMIME=function(e,t){ri[e]=t},e.resolveMode=function(t){if("string"==typeof t&&ri.hasOwnProperty(t))t=ri[t];else if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return e.resolveMode("application/xml");return"string"==typeof t?{name:t}:t||{name:"null"}},e.getMode=function(t,n){var n=e.resolveMode(n),r=ni[n.name];if(!r)return e.getMode(t,"text/plain");var i=r(t,n);if(ii.hasOwnProperty(n.name)){var s=ii[n.name];for(var o in s)s.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=s[o])}return i.name=n.name,i},e.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),e.defineMIME("text/plain","null");var ii=e.modeExtensions={};e.extendMode=function(e,t){var n=ii.hasOwnProperty(e)?ii[e]:ii[e]={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r])},e.defineExtension=function(t,n){e.prototype[t]=n},e.defineOption=Wt;var si=[];e.defineInitHook=function(e){si.push(e)},e.copyState=Xt,e.startState=Vt,e.innerMode=function(e,t){for(;e.innerMode;){var n=e.innerMode(t);t=n.state,e=n.mode}return n||{mode:e,state:t}};var oi=e.commands={selectAll:function(e){e.setSelection({line:0,ch:0},{line:e.lineCount()-1})},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!Nt(t,n);r||e.getLine(t.line).length!=t.ch?e.replaceRange("",t,r?n:{line:t.line},"delete"):e.replaceRange("",t,{line:t.line+1,ch:0},"delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",{line:t,ch:0},{line:t},"delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection({line:0,ch:0})},goDocEnd:function(e){e.extendSelection({line:e.lineCount()-1})},goLineStart:function(e){e.extendSelection(br(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=br(e,t.line),r=e.getLineHandle(n.line),i=Bn(r);if(i&&0!=i[0].level)e.extendSelection(n);else{var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;e.extendSelection({line:n.line,ch:o?0:s})}},goLineEnd:function(e){e.extendSelection(wr(e,e.getCursor().line))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);t.ch>0&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),{line:t.line,ch:t.ch-1},{line:t.line,ch:t.ch+1})},newlineAndIndent:function(e){$(e,function(){e.replaceSelection("\n","end","input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},ui=e.keyMap={};ui.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},ui.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goWordLeft","Ctrl-Right":"goWordRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delWordBefore","Ctrl-Delete":"delWordAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},ui.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goWordLeft","Alt-Right":"goWordRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delWordBefore","Ctrl-Alt-Backspace":"delWordAfter","Alt-Delete":"delWordAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore",fallthrough:["basic","emacsy"]},ui["default"]=Xr?ui.macDefault:ui.pcDefault,ui.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},e.isModifierKey=Kt,e.fromTextArea=function(t,n){function r(){t.value=a.getValue()}if(n||(n={}),n.value=t.value,!n.tabindex&&t.tabindex&&(n.tabindex=t.tabindex),null==n.autofocus){var i=document.body;try{i=document.activeElement}catch(s){}n.autofocus=i==t||null!=t.getAttribute("autofocus")&&i==document.body}if(t.form){$n(t.form,"submit",r);var o=t.form,u=o.submit;try{o.submit=function f(){r(),o.submit=u,o.submit(),o.submit=f}}catch(s){}}t.style.display="none";var a=e(function(e){t.parentNode.insertBefore(e,t.nextSibling)},n);return a.save=r,a.getTextArea=function(){return t},a.toTextArea=function(){r(),t.parentNode.removeChild(a.getWrapperElement()),t.style.display="",t.form&&(Jn(t.form,"submit",r),"function"==typeof t.form.submit&&(t.form.submit=u))},a},Qt.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return 0==this.pos},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(e){var t=this.string.charAt(this.pos);if("string"==typeof e)var n=t==e;else var n=t&&(e.test?e.test(t):e(t));return n?(++this.pos,t):void 0},eatWhile:function(e){for(var t=this.pos;this.eat(e););return this.pos>t},eatSpace:function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);return t>-1?(this.pos=t,!0):void 0},backUp:function(e){this.pos-=e},column:function(){return Zn(this.string,this.start,this.tabSize)},indentation:function(){return Zn(this.string,null,this.tabSize)},match:function(e,t,n){if("string"!=typeof e){var r=this.string.slice(this.pos).match(e);return r&&r.index>0?null:(r&&t!==!1&&(this.pos+=r[0].length),r)}var i=function(e){return n?e.toLowerCase():e};return i(this.string).indexOf(i(e),this.pos)==this.pos?(t!==!1&&(this.pos+=e.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)}},e.StringStream=Qt,Gt.prototype.clear=function(){if(!this.explicitlyCleared){X(this.cm);for(var e=null,t=null,n=0;n<this.lines.length;++n){var r=this.lines[n],i=Zt(r.markedSpans,this);null!=i.to&&(t=Dn(r)),r.markedSpans=en(r.markedSpans,i),null!=i.from?e=Dn(r):this.collapsed&&!cn(r)&&_n(r,z(this.cm.display))}null!=e&&J(this.cm,e,t+1),this.lines.length=0,this.explicitlyCleared=!0,this.collapsed&&this.cm.view.cantEdit&&(this.cm.view.cantEdit=!1,Dt(this.cm)),V(this.cm),Qn(this.cm,this,"clear")}},Gt.prototype.find=function(){for(var e,t,n=0;n<this.lines.length;++n){var r=this.lines[n],i=Zt(r.markedSpans,this);if(null!=i.from||null!=i.to){var s=Dn(r);null!=i.from&&(e={line:s,ch:i.from}),null!=i.to&&(t={line:s,ch:i.to})}}return"bookmark"==this.type?e:e&&{from:e,to:t}},window.lineIsHidden=cn;var ai={},fi=/[\t\u0000-\u0019\u200b\u2028\u2029\uFEFF]/g;An.prototype={chunkSize:function(){return this.lines.length},remove:function(e,t,n){for(var r=e,i=e+t;i>r;++r){var s=this.lines[r];this.height-=s.height,wn(s),Qn(n,s,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertHeight:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0,i=t.length;i>r;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;r>e;++e)if(n(this.lines[e]))return!0}},On.prototype={chunkSize:function(){return this.size},remove:function(e,t,n){this.size-=t;for(var r=0;r<this.children.length;++r){var i=this.children[r],s=i.chunkSize();if(s>e){var o=Math.min(t,s-e),u=i.height;if(i.remove(e,o,n),this.height-=u-i.height,s==o&&(this.children.splice(r--,1),i.parent=null),0==(t-=o))break;e=0}else e-=s}if(this.size-t<25){var a=[];this.collapse(a),this.children=[new An(a)],this.children[0].parent=this}},collapse:function(e){for(var t=0,n=this.children.length;n>t;++t)this.children[t].collapse(e)},insert:function(e,t){for(var n=0,r=0,i=t.length;i>r;++r)n+=t[r].height;this.insertHeight(e,t,n)},insertHeight:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>=e){if(s.insertHeight(e,t,n),s.lines&&s.lines.length>50){for(;s.lines.length>50;){var u=s.lines.splice(s.lines.length-25,25),a=new An(u);s.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new On(t);if(e.parent){e.size-=n.size,e.height-=n.height;var r=rr(e.parent.children,e);e.parent.children.splice(r+1,0,n)}else{var i=new On(e.children);i.parent=e,e.children=[i,n],e=i}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()}},iter:function(e,t,n){this.iterN(e,t-e,n)},iterN:function(e,t,n){for(var r=0,i=this.children.length;i>r;++r){var s=this.children[r],o=s.chunkSize();if(o>e){var u=Math.min(t,o-e);if(s.iterN(e,u,n))return!0;if(0==(t-=u))break;e=0}else e-=o}}},e.e_stop=zn,e.e_preventDefault=Rn,e.e_stopPropagation=Un,e.on=$n,e.off=Jn,e.signal=Kn;var li=30,ci=e.Pass={toString:function(){return"CodeMirror.Pass"}};Yn.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},e.countColumn=Zn;var hi=[""],pi=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc]/,di=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F]/,vi=function(){if(Dr)return!1;var e=ar("div");return"draggable"in e||"dragDrop"in e}(),mi=/^$/;Or?mi=/$'/:Fr?mi=/\-[^ \-?]|\?[^ !'\"\),.\-\/:;\?\]\}]/:Br&&(mi=/\-[^ \-\.?]|\?[^ \-\.?\]\}:;!'\"\),\/]|[\.!\"#&%\)*+,:;=>\]|\}~][\(\{\[<]|\$'/);var gi,yi,bi=3!="\n\nb".split(/\n/).length?function(e){for(var t=0,n=[],r=e.length;r>=t;){var i=e.indexOf("\n",t);-1==i&&(i=e.length);var s=e.slice(t,"\r"==e.charAt(i-1)?i-1:i),o=s.indexOf("\r");-1!=o?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};e.splitLines=bi;var wi=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return t&&t.parentElement()==e?0!=t.compareEndPoints("StartToEnd",t):!1},Ei=function(){var e=ar("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),"function"==typeof e.oncopy)}(),Si={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};e.keyNames=Si,function(){for(var e=0;10>e;e++)Si[e+48]=String(e);for(var e=65;90>=e;e++)Si[e]=String.fromCharCode(e);for(var e=1;12>=e;e++)Si[e+111]=Si[e+63235]="F"+e}();var xi=function(){function e(e){return 255>=e?t.charAt(e):e>=1424&&1524>=e?"R":e>=1536&&1791>=e?n.charAt(e-1536):e>=1792&&2220>=e?"r":"L"}var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",n="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/;return function(t){if(!r.test(t))return!1;for(var n,a=t.length,f=[],l=null,c=0;a>c;++c)f.push(n=e(t.charCodeAt(c))),null==l&&("L"==n?l="L":("R"==n||"r"==n)&&(l="R"));null==l&&(l="L");for(var c=0,h=l;a>c;++c){var n=f[c];"m"==n?f[c]=h:h=n}for(var c=0,p=l;a>c;++c){var n=f[c];"1"==n&&"r"==p?f[c]="n":s.test(n)&&(p=n,"r"==n&&(f[c]="R"))}for(var c=1,h=f[0];a-1>c;++c){var n=f[c];"+"==n&&"1"==h&&"1"==f[c+1]?f[c]="1":","!=n||h!=f[c+1]||"1"!=h&&"n"!=h||(f[c]=h),h=n}for(var c=0;a>c;++c){var n=f[c];if(","==n)f[c]="N";else if("%"==n){for(var d=c+1;a>d&&"%"==f[d];++d);for(var v=c&&"!"==f[c-1]||a-1>d&&"1"==f[d]?"1":"N",m=c;d>m;++m)f[m]=v;c=d-1}}for(var c=0,p=l;a>c;++c){var n=f[c];"L"==p&&"1"==n?f[c]="L":s.test(n)&&(p=n)}for(var c=0;a>c;++c)if(i.test(f[c])){for(var d=c+1;a>d&&i.test(f[d]);++d);for(var g="L"==(c?f[c-1]:l),y="L"==(a-1>d?f[d]:l),v=g||y?"L":"R",m=c;d>m;++m)f[m]=v;c=d-1}for(var b,w=[],c=0;a>c;)if(o.test(f[c])){var E=c;for(++c;a>c&&o.test(f[c]);++c);w.push({from:E,to:c,level:0})}else{var S=c,x=w.length;for(++c;a>c&&"L"!=f[c];++c);for(var m=S;c>m;)if(u.test(f[m])){m>S&&w.splice(x,0,{from:S,to:m,level:1});var T=m;for(++m;c>m&&u.test(f[m]);++m);w.splice(x,0,{from:T,to:m,level:2}),S=m}else++m;c>S&&w.splice(x,0,{from:S,to:c,level:1})}return 1==w[0].level&&(b=t.match(/^\s+/))&&(w[0].from=b[0].length,w.unshift({from:0,to:b[0].length,level:0})),1==tr(w).level&&(b=t.match(/\s+$/))&&(tr(w).to-=b[0].length,w.push({from:a-b[0].length,to:a,level:0})),w[0].level!=tr(w).level&&w.push({from:a,to:a,level:w[0].level}),w}}();return e.version="3.0",e}(),CodeMirror.defineMode("javascript",function(e,t){function n(e,t,n){return t.tokenize=n,n(e,t)}function r(e,t){for(var n,r=!1;null!=(n=e.next());){if(n==t&&!r)return!1;r=!r&&"\\"==n}return r}function i(e,t,n){return F=e,I=n,t}function s(e,t){var s=e.next();if('"'==s||"'"==s)return n(e,t,o(s));if(/[\[\]{}\(\),;\:\.]/.test(s))return i(s);if("0"==s&&e.eat(/x/i))return e.eatWhile(/[\da-f]/i),i("number","number");if(/\d/.test(s)||"-"==s&&e.eat(/\d/))return e.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),i("number","number");if("/"==s)return e.eat("*")?n(e,t,u):e.eat("/")?(e.skipToEnd(),i("comment","comment")):"operator"==t.lastType||"keyword c"==t.lastType||/^[\[{}\(,;:]$/.test(t.lastType)?(r(e,"/"),e.eatWhile(/[gimy]/),i("regexp","string-2")):(e.eatWhile(W),i("operator",null,e.current()));if("#"==s)return e.skipToEnd(),i("error","error");if(W.test(s))return e.eatWhile(W),i("operator",null,e.current());e.eatWhile(/[\w\$_]/);var a=e.current(),f=z.propertyIsEnumerable(a)&&z[a];return f&&"."!=t.lastType?i(f.type,f.style,a):i("variable","variable",a)}function o(e){return function(t,n){return r(t,e)||(n.tokenize=s),i("string","string")}}function u(e,t){for(var n,r=!1;n=e.next();){if("/"==n&&r){t.tokenize=s;break}r="*"==n}return i("comment","comment")}function a(e,t,n,r,i,s){this.indented=e,this.column=t,this.type=n,this.prev=i,this.info=s,null!=r&&(this.align=r)}function f(e,t){for(var n=e.localVars;n;n=n.next)if(n.name==t)return!0}function l(e,t,n,r,i){var s=e.cc;for(V.state=e,V.stream=i,V.marked=null,V.cc=s,e.lexical.hasOwnProperty("align")||(e.lexical.align=!0);;){var o=s.length?s.pop():R?w:b;if(o(n,r)){for(;s.length&&s[s.length-1].lex;)s.pop()();return V.marked?V.marked:"variable"==n&&f(e,r)?"variable-2":t}}}function c(){for(var e=arguments.length-1;e>=0;e--)V.cc.push(arguments[e])}function h(){return c.apply(null,arguments),!0}function p(e){var t=V.state;if(t.context){V.marked="def";for(var n=t.localVars;n;n=n.next)if(n.name==e)return;t.localVars={name:e,next:t.localVars}}}function d(){V.state.context={prev:V.state.context,vars:V.state.localVars},V.state.localVars=$}function v(){V.state.localVars=V.state.context.vars,V.state.context=V.state.context.prev}function m(e,t){var n=function(){var n=V.state;n.lexical=new a(n.indented,V.stream.column(),e,null,n.lexical,t)};return n.lex=!0,n}function g(){var e=V.state;e.lexical.prev&&(")"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function y(e){return function(t){return t==e?h():";"==e?c():h(arguments.callee)}}function b(e){return"var"==e?h(m("vardef"),O,y(";"),g):"keyword a"==e?h(m("form"),w,b,g):"keyword b"==e?h(m("form"),b,g):"{"==e?h(m("}"),k,g):";"==e?h():"function"==e?h(B):"for"==e?h(m("form"),y("("),m(")"),_,y(")"),g,b,g):"variable"==e?h(m("stat"),x):"switch"==e?h(m("form"),w,m("}","switch"),y("{"),k,g,g):"case"==e?h(w,y(":")):"default"==e?h(y(":")):"catch"==e?h(m("form"),d,y("("),j,y(")"),b,g,v):c(m("stat"),w,y(";"),g)}function w(e){return X.hasOwnProperty(e)?h(S):"function"==e?h(B):"keyword c"==e?h(E):"("==e?h(m(")"),E,y(")"),g,S):"operator"==e?h(w):"["==e?h(m("]"),C(w,"]"),g,S):"{"==e?h(m("}"),C(N,"}"),g,S):h()}function E(e){return e.match(/[;\}\)\],]/)?c():c(w)}function S(e,t){if("operator"==e&&/\+\+|--/.test(t))return h(S);if("operator"==e&&"?"==t)return h(w,y(":"),w);if(";"!=e)return"("==e?h(m(")"),C(w,")"),g,S):"."==e?h(T,S):"["==e?h(m("]"),w,y("]"),g,S):void 0}function x(e){return":"==e?h(g,b):c(S,y(";"),g)}function T(e){return"variable"==e?(V.marked="property",h()):void 0}function N(e){return"variable"==e&&(V.marked="property"),X.hasOwnProperty(e)?h(y(":"),w):void 0}function C(e,t){function n(r){return","==r?h(e,n):r==t?h():h(y(t))}return function(r){return r==t?h():c(e,n)}}function k(e){return"}"==e?h():c(b,k)}function L(e){return":"==e?h(A):c()}function A(e){return"variable"==e?(V.marked="variable-3",h()):c()}function O(e,t){return"variable"==e?(p(t),U?h(L,M):h(M)):c()}function M(e,t){return"="==t?h(w,M):","==e?h(O):void 0}function _(e){return"var"==e?h(O,y(";"),P):";"==e?h(P):"variable"==e?h(D):h(P)}function D(e,t){return"in"==t?h(w):h(S,P)}function P(e,t){return";"==e?h(H):"in"==t?h(w):h(w,y(";"),H)}function H(e){")"!=e&&h(w)}function B(e,t){return"variable"==e?(p(t),h(B)):"("==e?h(m(")"),d,C(j,")"),g,b,v):void 0}function j(e,t){return"variable"==e?(p(t),U?h(L):h()):void 0}var F,I,q=e.indentUnit,R=t.json,U=t.typescript,z=function(){function e(e){return{type:e,style:"keyword"}}var t=e("keyword a"),n=e("keyword b"),r=e("keyword c"),i=e("operator"),s={type:"atom",style:"atom"},o={"if":t,"while":t,"with":t,"else":n,"do":n,"try":n,"finally":n,"return":r,"break":r,"continue":r,"new":r,"delete":r,"throw":r,"var":e("var"),"const":e("var"),let:e("var"),"function":e("function"),"catch":e("catch"),"for":e("for"),"switch":e("switch"),"case":e("case"),"default":e("default"),"in":i,"typeof":i,"instanceof":i,"true":s,"false":s,"null":s,"undefined":s,NaN:s,Infinity:s};if(U){var u={type:"variable",style:"variable-3"},a={"interface":e("interface"),"class":e("class"),"extends":e("extends"),constructor:e("constructor"),"public":e("public"),"private":e("private"),"protected":e("protected"),"static":e("static"),"super":e("super"),string:u,number:u,bool:u,any:u};for(var f in a)o[f]=a[f]}return o}(),W=/[+\-*&%=<>!?|]/,X={atom:!0,number:!0,variable:!0,string:!0,regexp:!0},V={state:null,column:null,marked:null,cc:null},$={name:"this",next:{name:"arguments"}};return g.lex=!0,{startState:function(e){return{tokenize:s,lastType:null,cc:[],lexical:new a((e||0)-q,0,"block",!1),localVars:t.localVars,context:t.localVars&&{vars:t.localVars},indented:0}},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty("align")||(t.lexical.align=!1),t.indented=e.indentation()),e.eatSpace())return null;var n=t.tokenize(e,t);return"comment"==F?n:(t.lastType=F,l(t,n,F,I,e))},indent:function(e,t){if(e.tokenize==u)return CodeMirror.Pass;if(e.tokenize!=s)return 0;var n=t&&t.charAt(0),r=e.lexical;"stat"==r.type&&"}"==n&&(r=r.prev);var i=r.type,o=n==i;return"vardef"==i?r.indented+("operator"==e.lastType||","==e.lastType?4:0):"form"==i&&"{"==n?r.indented:"form"==i?r.indented+q:"stat"==i?r.indented+("operator"==e.lastType||","==e.lastType?q:0):"switch"!=r.info||o?r.align?r.column+(o?0:1):r.indented+(o?0:q):r.indented+(/^(?:case|default)\b/.test(t)?q:2*q)},electricChars:":{}",jsonMode:R}}),CodeMirror.defineMIME("text/javascript","javascript"),CodeMirror.defineMIME("application/json",{name:"javascript",json:!0}),CodeMirror.defineMIME("text/typescript",{name:"javascript",typescript:!0}),CodeMirror.defineMIME("application/typescript",{name:"javascript",typescript:!0}),function(){function e(e,t,n,r){if(this.atOccurrence=!1,this.cm=e,null==r&&"string"==typeof t&&(r=!1),n=n?e.clipPos(n):{line:0,ch:0},this.pos={from:n,to:n},"string"!=typeof t)t.global||(t=new RegExp(t.source,t.ignoreCase?"ig":"g")),this.matches=function(n,r){if(n){t.lastIndex=0;for(var i=e.getLine(r.line).slice(0,r.ch),s=t.exec(i),o=0;s;){o+=s.index+1,i=i.slice(o),t.lastIndex=0;var u=t.exec(i);if(!u)break;s=u}o--}else{t.lastIndex=r.ch;var i=e.getLine(r.line),s=t.exec(i),o=s&&s.index}return s?{from:{line:r.line,ch:o},to:{line:r.line,ch:o+s[0].length},match:s}:void 0};else{r&&(t=t.toLowerCase());var i=r?function(e){return e.toLowerCase()}:function(e){return e},s=t.split("\n");this.matches=1==s.length?function(n,r){var s,o=i(e.getLine(r.line)),u=t.length;return(n?r.ch>=u&&-1!=(s=o.lastIndexOf(t,r.ch-u)):-1!=(s=o.indexOf(t,r.ch)))?{from:{line:r.line,ch:s},to:{line:r.line,ch:s+u}}:void 0}:function(t,n){var r=n.line,o=t?s.length-1:0,u=s[o],l=i(e.getLine(r)),c=t?l.indexOf(u)+u.length:l.lastIndexOf(u);if(!(t?c>=n.ch||c!=u.length:c<=n.ch||c!=l.length-u.length))for(;;){if(t?!r:r==e.lineCount()-1)return;if(l=i(e.getLine(r+=t?-1:1)),u=s[t?--o:++o],!(o>0&&o<s.length-1)){var h=t?l.lastIndexOf(u):l.indexOf(u)+u.length;if(t?h!=l.length-u.length:h!=u.length)return;var p={line:n.line,ch:c},d={line:r,ch:h};return{from:t?d:p,to:t?p:d}}if(l!=u)return}}}}e.prototype={findNext:function(){return this.find(!1)},findPrevious:function(){return this.find(!0)},find:function(e){function t(e){var t={line:e,ch:0};return n.pos={from:t,to:t},n.atOccurrence=!1,!1}for(var n=this,r=this.cm.clipPos(e?this.pos.from:this.pos.to);;){if(this.pos=this.matches(e,r))return this.atOccurrence=!0,this.pos.match||!0;if(e){if(!r.line)return t(0);r={line:r.line-1,ch:this.cm.getLine(r.line-1).length}}else{var i=this.cm.lineCount();if(r.line==i-1)return t(i);r={line:r.line+1,ch:0}}}},from:function(){return this.atOccurrence?this.pos.from:void 0},to:function(){return this.atOccurrence?this.pos.to:void 0},replace:function(e){var t=this;this.atOccurrence&&(t.pos.to=this.cm.replaceRange(e,t.pos.from,t.pos.to))}},CodeMirror.defineExtension("getSearchCursor",function(t,n,r){return new e(this,t,n,r)})}();