$(function(){function n(){$(".js-file-chart").each(function(){var e=$(this),n=e.width()-130;e.empty();var r=e.data("complexity");e.append(t(r,Math.min(r*2,n),"complexity",[5,10])),r=e.data("sloc"),e.append(t(r,Math.min(r,n),"sloc",[400,600])),r=e.data("bugs"),e.append(t(r,Math.min(r*5,n),"est errors",[1,5])),r=e.data("lint"),e.append(t(r,Math.min(r*5,n),"lint errors",[1,10]))})}function r(e){function s(e){document.location=__report.reports[e].info.link}var t={element:"chart_maintainability",data:[],xkey:"label",ykeys:["value"],ymax:100,ymin:0,labels:["Maintainability"],barColors:["#ff9b40"]},n={element:"chart_sloc",data:[],xkey:"label",ykeys:["value"],ymax:400,labels:["Lines"],barColors:["#1f6b75"]},r={element:"chart_bugs",data:[],xkey:"label",ykeys:["value"],labels:["Errors"],ymax:20,barColors:["#ff9b40"]},i={element:"chart_lint",data:[],xkey:"label",ykeys:["value"],labels:["Errors"],ymax:20,barColors:["#1f6b75"]};e.forEach(function(e){n.ymax=Math.max(n.ymax,e.complexity.aggregate.complexity.sloc.physical),r.ymax=Math.max(r.ymax,e.complexity.aggregate.complexity.halstead.bugs.toFixed(2)),n.data.push({value:e.complexity.aggregate.complexity.sloc.physical,label:e.info.fileShort}),r.data.push({value:e.complexity.aggregate.complexity.halstead.bugs.toFixed(2),label:e.info.fileShort}),t.data.push({value:e.complexity.maintainability?e.complexity.maintainability.toFixed(2):0,label:e.info.fileShort}),i.data.push({value:e.jshint&&e.jshint.messages,label:e.info.fileShort})});var o=[Morris.Bar(r),Morris.Bar(n),Morris.Bar(t)];return __options.flags.jshint&&o.push(Morris.Bar(i)),o.forEach(function(e){e.on("click",s)}),o}function i(e){var t=_.map(e,function(e){var t=new Date(e.date);return{date:t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate(),average_maintainability:parseFloat(e.average.maintainability),average_sloc:e.average.sloc}}).slice(-20);Morris.Line({element:"chart_historical_sloc",data:t,xkey:"date",ykeys:["average_sloc"],labels:["Average Lines"],parseTime:!1}),Morris.Line({element:"chart_historical_maint",data:t,xkey:"date",ykeys:["average_maintainability"],labels:["Maintainability"],ymax:100,parseTime:!1})}function s(){$(".js-chart").empty(),i(__history),r(__report.reports),n(__report.reports)}$("[rel=popover]").popover();var e=_.template('<div class="threshold-<%= threshold %>"><label><%= label %></label><span class="horizontal-bar" style="width:<%= width %>px"></span><span class="chart-value"><%= value %></span></div>'),t=function(t,n,r,i){var s=0;for(var o=i.length-1;o>-1;o--)if(t>i[o]){s=o+1;break}return e({width:n,label:r,threshold:s,value:t})};s(),$(window).on("resize",_.debounce(s,200))});