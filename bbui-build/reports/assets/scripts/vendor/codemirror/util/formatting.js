(function(){CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t){return/^[;{}]$/.test(t)}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(e,t,n,r){return this.jsonMode?/^[\[,{]$/.test(t)||/^}/.test(n):t==";"&&r.lexical&&r.lexical.type==")"?!1:/^[;{}]$/.test(t)&&!/^;/.test(n)}}),CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",newlineAfterToken:function(e,t,n){return e=="tag"&&/>$/.test(t)||/^</.test(n)}}),CodeMirror.defineExtension("commentRange",function(e,t,n){var r=this,i=CodeMirror.innerMode(r.getMode(),r.getTokenAt(t).state).mode;r.operation(function(){if(e)r.replaceRange(i.commentEnd,n),r.replaceRange(i.commentStart,t),t.line==n.line&&t.ch==n.ch&&r.setCursor(t.line,t.ch+i.commentStart.length);else{var s=r.getRange(t,n),o=s.indexOf(i.commentStart),u=s.lastIndexOf(i.commentEnd);o>-1&&u>-1&&u>o&&(s=s.substr(0,o)+s.substring(o+i.commentStart.length,u)+s.substr(u+i.commentEnd.length)),r.replaceRange(s,t,n)}})}),CodeMirror.defineExtension("autoIndentRange",function(e,t){var n=this;this.operation(function(){for(var r=e.line;r<=t.line;r++)n.indentLine(r,"smart")})}),CodeMirror.defineExtension("autoFormatRange",function(e,t){function l(){u+="\n",f=!0,++a}var n=this,r=n.getMode(),i=n.getRange(e,t).split("\n"),s=CodeMirror.copyState(r,n.getTokenAt(e).state),o=n.getOption("tabSize"),u="",a=0,f=e.ch==0;for(var c=0;c<i.length;++c){var h=new CodeMirror.StringStream(i[c],o);while(!h.eol()){var p=CodeMirror.innerMode(r,s),d=r.token(h,s),v=h.current();h.start=h.pos;if(!f||/\S/.test(v))u+=v,f=!1;!f&&p.mode.newlineAfterToken&&p.mode.newlineAfterToken(d,v,h.string.slice(h.pos)||i[c+1]||"",p.state)&&l()}!h.pos&&r.blankLine&&r.blankLine(s),f||l()}n.operation(function(){n.replaceRange(u,e,t);for(var r=e.line+1,i=e.line+a;r<=i;++r)n.indentLine(r,"smart");n.setSelection(e,n.getCursor(!1))})})})();